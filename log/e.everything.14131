Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Not an error, but Unsloth cannot patch Attention layers with our manual autograd engine since either LoRA adapters
are not enabled or a bias term (like in Qwen) is used.
Unsloth 2024.5 patched 32 layers with 0 QKV layers, 32 O layers and 32 MLP layers.
Map:   0%|          | 0/100000 [00:00<?, ? examples/s]Map:   0%|          | 1/100000 [00:00<14:39:10,  1.90 examples/s]Map:   1%|          | 622/100000 [00:00<01:15, 1324.42 examples/s]Map:   1%|          | 1038/100000 [00:00<00:49, 1984.92 examples/s]Map:   2%|▏         | 1688/100000 [00:00<00:31, 3111.45 examples/s]Map:   2%|▏         | 2310/100000 [00:01<00:36, 2699.75 examples/s]Map:   3%|▎         | 2952/100000 [00:01<00:28, 3462.20 examples/s]Map:   4%|▍         | 3754/100000 [00:01<00:23, 4035.44 examples/s]Map:   4%|▍         | 4309/100000 [00:01<00:22, 4190.52 examples/s]Map:   5%|▍         | 4948/100000 [00:01<00:20, 4706.84 examples/s]Map:   6%|▌         | 5737/100000 [00:01<00:19, 4889.43 examples/s]Map:   6%|▋         | 6311/100000 [00:01<00:19, 4900.60 examples/s]Map:   7%|▋         | 6947/100000 [00:01<00:17, 5262.79 examples/s]Map:   8%|▊         | 7668/100000 [00:02<00:18, 5102.12 examples/s]Map:   8%|▊         | 8457/100000 [00:02<00:17, 5150.90 examples/s]Map:   9%|▉         | 9000/100000 [00:02<00:17, 5107.14 examples/s]Map:  10%|▉         | 9629/100000 [00:02<00:16, 5403.55 examples/s]Map:  10%|█         | 10420/100000 [00:02<00:16, 5354.94 examples/s]Map:  11%|█         | 11000/100000 [00:02<00:16, 5253.69 examples/s]Map:  12%|█▏        | 11632/100000 [00:02<00:15, 5523.28 examples/s]Map:  12%|█▏        | 12429/100000 [00:02<00:16, 5445.86 examples/s]Map:  13%|█▎        | 13000/100000 [00:03<00:16, 5325.79 examples/s]Map:  14%|█▎        | 13631/100000 [00:03<00:15, 5576.75 examples/s]Map:  14%|█▍        | 14426/100000 [00:03<00:15, 5473.55 examples/s]Map:  15%|█▌        | 15000/100000 [00:03<00:15, 5344.16 examples/s]Map:  16%|█▌        | 15634/100000 [00:03<00:15, 5600.65 examples/s]Map:  16%|█▋        | 16430/100000 [00:03<00:15, 5493.60 examples/s]Map:  17%|█▋        | 17040/100000 [00:03<00:21, 3926.58 examples/s]Map:  18%|█▊        | 17677/100000 [00:04<00:18, 4416.99 examples/s]Map:  18%|█▊        | 18473/100000 [00:04<00:17, 4681.59 examples/s]Map:  19%|█▉        | 19000/100000 [00:04<00:17, 4751.42 examples/s]Map:  20%|█▉        | 19634/100000 [00:04<00:15, 5130.52 examples/s]Map:  20%|██        | 20430/100000 [00:04<00:15, 5186.37 examples/s]Map:  21%|██        | 21000/100000 [00:04<00:15, 5156.81 examples/s]Map:  22%|██▏       | 21634/100000 [00:04<00:14, 5452.49 examples/s]Map:  22%|██▏       | 22426/100000 [00:04<00:14, 5388.92 examples/s]Map:  23%|██▎       | 23000/100000 [00:05<00:14, 5293.40 examples/s]Map:  24%|██▎       | 23629/100000 [00:05<00:13, 5548.73 examples/s]Map:  24%|██▍       | 24435/100000 [00:05<00:13, 5482.63 examples/s]Map:  25%|██▌       | 25000/100000 [00:05<00:14, 5022.23 examples/s]Map:  26%|██▌       | 25630/100000 [00:05<00:13, 5336.90 examples/s]Map:  26%|██▋       | 26419/100000 [00:05<00:13, 5307.50 examples/s]Map:  27%|██▋       | 27000/100000 [00:05<00:13, 5221.94 examples/s]Map:  28%|██▊       | 27632/100000 [00:05<00:13, 5497.99 examples/s]Map:  28%|██▊       | 28432/100000 [00:06<00:13, 5436.84 examples/s]Map:  29%|██▉       | 29000/100000 [00:06<00:13, 5330.18 examples/s]Map:  30%|██▉       | 29631/100000 [00:06<00:12, 5580.45 examples/s]Map:  30%|███       | 30429/100000 [00:06<00:12, 5484.41 examples/s]Map:  31%|███       | 31000/100000 [00:06<00:17, 3921.30 examples/s]Map:  32%|███▏      | 31634/100000 [00:06<00:15, 4412.68 examples/s]Map:  32%|███▏      | 32368/100000 [00:06<00:14, 4557.07 examples/s]Map:  33%|███▎      | 33000/100000 [00:07<00:14, 4723.53 examples/s]Map:  34%|███▎      | 33639/100000 [00:07<00:12, 5111.55 examples/s]Map:  34%|███▍      | 34441/100000 [00:07<00:12, 5187.65 examples/s]Map:  35%|███▌      | 35000/100000 [00:07<00:12, 5146.86 examples/s]Map:  36%|███▌      | 35629/100000 [00:07<00:11, 5430.85 examples/s]Map:  36%|███▋      | 36433/100000 [00:07<00:11, 5403.46 examples/s]Map:  37%|███▋      | 37000/100000 [00:07<00:11, 5305.73 examples/s]Map:  38%|███▊      | 37637/100000 [00:07<00:11, 5576.40 examples/s]Map:  38%|███▊      | 38444/100000 [00:08<00:11, 5502.64 examples/s]Map:  39%|███▉      | 39312/100000 [00:08<00:11, 5478.17 examples/s]Map:  40%|███▉      | 39957/100000 [00:08<00:10, 5709.03 examples/s]Map:  41%|████      | 40754/100000 [00:08<00:10, 5572.27 examples/s]Map:  42%|████▏     | 41634/100000 [00:08<00:10, 5479.19 examples/s]Map:  42%|████▏     | 42434/100000 [00:08<00:10, 5432.21 examples/s]Map:  43%|████▎     | 43000/100000 [00:08<00:10, 5336.68 examples/s]Map:  44%|████▎     | 43637/100000 [00:08<00:10, 5583.69 examples/s]Map:  44%|████▍     | 44441/100000 [00:09<00:10, 5504.49 examples/s]Map:  45%|████▌     | 45000/100000 [00:09<00:10, 5387.84 examples/s]Map:  46%|████▌     | 45635/100000 [00:09<00:09, 5630.61 examples/s]Map:  46%|████▋     | 46309/100000 [00:09<00:13, 3976.42 examples/s]Map:  47%|████▋     | 46953/100000 [00:09<00:11, 4475.05 examples/s]Map:  48%|████▊     | 47749/100000 [00:09<00:11, 4725.84 examples/s]Map:  48%|████▊     | 48315/100000 [00:09<00:10, 4795.78 examples/s]Map:  49%|████▉     | 48962/100000 [00:10<00:09, 5190.09 examples/s]Map:  50%|████▉     | 49759/100000 [00:10<00:09, 5229.53 examples/s]Map:  50%|█████     | 50310/100000 [00:10<00:10, 4580.86 examples/s]Map:  51%|█████     | 50952/100000 [00:10<00:09, 5003.74 examples/s]Map:  52%|█████▏    | 51754/100000 [00:10<00:09, 5114.34 examples/s]Map:  52%|█████▏    | 52312/100000 [00:10<00:09, 5048.64 examples/s]Map:  53%|█████▎    | 52954/100000 [00:10<00:08, 5386.14 examples/s]Map:  54%|█████▍    | 53761/100000 [00:11<00:08, 5380.45 examples/s]Map:  54%|█████▍    | 54314/100000 [00:11<00:08, 5272.97 examples/s]Map:  55%|█████▍    | 54960/100000 [00:11<00:08, 5575.59 examples/s]Map:  56%|█████▌    | 55773/100000 [00:11<00:08, 5516.49 examples/s]Map:  57%|█████▋    | 56632/100000 [00:11<00:07, 5467.27 examples/s]Map:  57%|█████▋    | 57429/100000 [00:11<00:07, 5416.73 examples/s]Map:  58%|█████▊    | 58000/100000 [00:11<00:07, 5331.80 examples/s]Map:  59%|█████▊    | 58632/100000 [00:11<00:07, 5572.21 examples/s]Map:  59%|█████▉    | 59432/100000 [00:12<00:07, 5488.44 examples/s]Map:  60%|██████    | 60000/100000 [00:12<00:07, 5335.56 examples/s]Map:  61%|██████    | 60647/100000 [00:12<00:07, 5620.19 examples/s]Map:  61%|██████▏   | 61312/100000 [00:12<00:09, 3974.92 examples/s]Map:  62%|██████▏   | 61956/100000 [00:12<00:08, 4477.03 examples/s]Map:  63%|██████▎   | 62763/100000 [00:12<00:07, 4750.00 examples/s]Map:  63%|██████▎   | 63314/100000 [00:12<00:07, 4778.94 examples/s]Map:  64%|██████▍   | 63961/100000 [00:13<00:06, 5178.39 examples/s]Map:  65%|██████▍   | 64765/100000 [00:13<00:06, 5238.58 examples/s]Map:  66%|██████▌   | 65636/100000 [00:13<00:06, 5300.05 examples/s]Map:  66%|██████▋   | 66436/100000 [00:13<00:06, 5308.36 examples/s]Map:  67%|██████▋   | 67000/100000 [00:13<00:06, 5235.75 examples/s]Map:  68%|██████▊   | 67638/100000 [00:13<00:05, 5509.84 examples/s]Map:  68%|██████▊   | 68435/100000 [00:13<00:05, 5441.12 examples/s]Map:  69%|██████▉   | 69000/100000 [00:13<00:05, 5344.05 examples/s]Map:  70%|██████▉   | 69637/100000 [00:14<00:05, 5603.34 examples/s]Map:  70%|███████   | 70435/100000 [00:14<00:05, 5500.39 examples/s]Map:  71%|███████   | 71000/100000 [00:14<00:05, 5381.20 examples/s]Map:  72%|███████▏  | 71635/100000 [00:14<00:05, 5628.95 examples/s]Map:  72%|███████▏  | 72443/100000 [00:14<00:04, 5539.34 examples/s]Map:  73%|███████▎  | 73309/100000 [00:14<00:04, 5497.21 examples/s]Map:  74%|███████▍  | 73951/100000 [00:14<00:04, 5715.80 examples/s]Map:  75%|███████▍  | 74744/100000 [00:14<00:04, 5567.54 examples/s]Map:  75%|███████▌  | 75314/100000 [00:15<00:04, 5414.38 examples/s]Map:  76%|███████▌  | 76000/100000 [00:15<00:06, 3983.06 examples/s]Map:  77%|███████▋  | 76634/100000 [00:15<00:05, 4450.30 examples/s]Map:  77%|███████▋  | 77433/100000 [00:15<00:04, 4709.06 examples/s]Map:  78%|███████▊  | 78000/100000 [00:15<00:04, 4768.02 examples/s]Map:  79%|███████▊  | 78641/100000 [00:15<00:04, 5150.64 examples/s]Map:  79%|███████▉  | 79449/100000 [00:15<00:03, 5225.58 examples/s]Map:  80%|████████  | 80000/100000 [00:16<00:03, 5186.74 examples/s]Map:  81%|████████  | 80631/100000 [00:16<00:03, 5468.90 examples/s]Map:  81%|████████▏ | 81437/100000 [00:16<00:03, 5431.24 examples/s]Map:  82%|████████▏ | 82000/100000 [00:16<00:03, 5307.01 examples/s]Map:  83%|████████▎ | 82633/100000 [00:16<00:03, 5567.53 examples/s]Map:  83%|████████▎ | 83437/100000 [00:16<00:03, 5488.96 examples/s]Map:  84%|████████▍ | 84000/100000 [00:16<00:02, 5349.10 examples/s]Map:  85%|████████▍ | 84639/100000 [00:16<00:02, 5617.06 examples/s]Map:  85%|████████▌ | 85445/100000 [00:17<00:02, 5526.09 examples/s]Map:  86%|████████▋ | 86315/100000 [00:17<00:02, 5503.81 examples/s]Map:  87%|████████▋ | 86964/100000 [00:17<00:02, 5738.62 examples/s]Map:  88%|████████▊ | 87766/100000 [00:17<00:02, 5602.04 examples/s]Map:  89%|████████▊ | 88636/100000 [00:17<00:02, 5536.43 examples/s]Map:  89%|████████▉ | 89423/100000 [00:17<00:01, 5442.15 examples/s]Map:  90%|█████████ | 90000/100000 [00:18<00:02, 4017.79 examples/s]Map:  91%|█████████ | 90635/100000 [00:18<00:02, 4464.84 examples/s]Map:  91%|█████████▏| 91438/100000 [00:18<00:01, 4721.87 examples/s]Map:  92%|█████████▏| 92000/100000 [00:18<00:01, 4807.51 examples/s]Map:  93%|█████████▎| 92639/100000 [00:18<00:01, 5174.82 examples/s]Map:  93%|█████████▎| 93446/100000 [00:18<00:01, 5239.79 examples/s]Map:  94%|█████████▍| 94000/100000 [00:18<00:01, 5145.59 examples/s]Map:  95%|█████████▍| 94630/100000 [00:18<00:00, 5430.53 examples/s]Map:  95%|█████████▌| 95429/100000 [00:19<00:00, 5391.86 examples/s]Map:  96%|█████████▌| 96000/100000 [00:19<00:00, 5294.85 examples/s]Map:  97%|█████████▋| 96633/100000 [00:19<00:00, 5556.93 examples/s]Map:  97%|█████████▋| 97436/100000 [00:19<00:00, 5481.98 examples/s]Map:  98%|█████████▊| 98000/100000 [00:19<00:00, 5367.61 examples/s]Map:  99%|█████████▊| 98638/100000 [00:19<00:00, 5627.03 examples/s]Map:  99%|█████████▉| 99444/100000 [00:19<00:00, 5533.04 examples/s]Map: 100%|██████████| 100000/100000 [00:19<00:00, 5010.22 examples/s]
Map:   0%|          | 0/10000 [00:00<?, ? examples/s]Map:   6%|▋         | 646/10000 [00:00<00:01, 6392.69 examples/s]Map:  14%|█▍        | 1430/10000 [00:00<00:01, 5587.52 examples/s]Map:  20%|██        | 2000/10000 [00:00<00:01, 5363.92 examples/s]Map:  26%|██▋       | 2640/10000 [00:00<00:01, 5722.61 examples/s]Map:  34%|███▍      | 3446/10000 [00:00<00:01, 5569.34 examples/s]Map:  43%|████▎     | 4313/10000 [00:00<00:01, 5411.28 examples/s]Map:  50%|█████     | 5000/10000 [00:01<00:01, 3942.06 examples/s]Map:  56%|█████▋    | 5642/10000 [00:01<00:00, 4436.76 examples/s]Map:  64%|██████▍   | 6446/10000 [00:01<00:00, 4711.94 examples/s]Map:  70%|███████   | 7000/10000 [00:01<00:00, 4666.99 examples/s]Map:  76%|███████▋  | 7635/10000 [00:01<00:00, 5056.11 examples/s]Map:  84%|████████▍ | 8432/10000 [00:01<00:00, 5139.48 examples/s]Map:  90%|█████████ | 9000/10000 [00:01<00:00, 5099.22 examples/s]Map:  96%|█████████▋| 9634/10000 [00:01<00:00, 5406.71 examples/s]Map: 100%|██████████| 10000/10000 [00:01<00:00, 5038.92 examples/s]
/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/sum/ufj45ra/faithful_reasoning/ft_unsloth_llama3.py", line 166, in <module>
    trainer = SFTTrainer(
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/trl/trainer/sft_trainer.py", line 189, in __init__
    if args.packing and data_collator is not None and isinstance(data_collator, DataCollatorForCompletionOnlyLM):
AttributeError: 'TrainingArguments' object has no attribute 'packing'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Not an error, but Unsloth cannot patch Attention layers with our manual autograd engine since either LoRA adapters
are not enabled or a bias term (like in Qwen) is used.
Unsloth 2024.5 patched 32 layers with 0 QKV layers, 32 O layers and 32 MLP layers.
Map:   0%|          | 0/100000 [00:00<?, ? examples/s]Map:   0%|          | 1/100000 [00:00<3:37:04,  7.68 examples/s]Map:   1%|          | 620/100000 [00:00<00:30, 3238.68 examples/s]Map:   1%|          | 1001/100000 [00:00<00:28, 3462.39 examples/s]Map:   2%|▏         | 1643/100000 [00:00<00:21, 4577.42 examples/s]Map:   2%|▏         | 2306/100000 [00:00<00:30, 3163.71 examples/s]Map:   3%|▎         | 2938/100000 [00:00<00:24, 3889.07 examples/s]Map:   4%|▎         | 3694/100000 [00:00<00:22, 4267.29 examples/s]Map:   4%|▍         | 4309/100000 [00:01<00:21, 4439.73 examples/s]Map:   5%|▍         | 4946/100000 [00:01<00:19, 4907.00 examples/s]Map:   6%|▌         | 5726/100000 [00:01<00:18, 5005.06 examples/s]Map:   6%|▋         | 6306/100000 [00:01<00:18, 4941.50 examples/s]Map:   7%|▋         | 6943/100000 [00:01<00:17, 5296.78 examples/s]Map:   8%|▊         | 7711/100000 [00:01<00:17, 5232.21 examples/s]Map:   8%|▊         | 8308/100000 [00:01<00:18, 4853.75 examples/s]Map:   9%|▉         | 8946/100000 [00:01<00:17, 5222.40 examples/s]Map:  10%|▉         | 9731/100000 [00:02<00:17, 5222.21 examples/s]Map:  10%|█         | 10309/100000 [00:02<00:17, 5123.39 examples/s]Map:  11%|█         | 10947/100000 [00:02<00:16, 5437.04 examples/s]Map:  12%|█▏        | 11704/100000 [00:02<00:16, 5298.59 examples/s]Map:  12%|█▏        | 12309/100000 [00:02<00:16, 5188.90 examples/s]Map:  13%|█▎        | 12945/100000 [00:02<00:15, 5481.15 examples/s]Map:  14%|█▎        | 13734/100000 [00:02<00:15, 5400.74 examples/s]Map:  14%|█▍        | 14310/100000 [00:02<00:16, 5245.54 examples/s]Map:  15%|█▍        | 14941/100000 [00:03<00:15, 5515.99 examples/s]Map:  16%|█▌        | 15622/100000 [00:03<00:16, 4991.13 examples/s]Map:  16%|█▋        | 16385/100000 [00:03<00:16, 5020.18 examples/s]Map:  17%|█▋        | 16921/100000 [00:03<00:21, 3900.14 examples/s]Map:  17%|█▋        | 17359/100000 [00:03<00:20, 3997.43 examples/s]Map:  18%|█▊        | 17999/100000 [00:03<00:18, 4542.08 examples/s]Map:  19%|█▉        | 18778/100000 [00:03<00:17, 4753.21 examples/s]Map:  19%|█▉        | 19311/100000 [00:04<00:16, 4774.10 examples/s]Map:  20%|█▉        | 19951/100000 [00:04<00:15, 5175.94 examples/s]Map:  21%|██        | 20731/100000 [00:04<00:15, 5182.52 examples/s]Map:  21%|██▏       | 21311/100000 [00:04<00:15, 5023.12 examples/s]Map:  22%|██▏       | 21953/100000 [00:04<00:14, 5370.21 examples/s]Map:  23%|██▎       | 22712/100000 [00:04<00:14, 5258.57 examples/s]Map:  23%|██▎       | 23309/100000 [00:04<00:14, 5164.85 examples/s]Map:  24%|██▍       | 23945/100000 [00:04<00:13, 5466.08 examples/s]Map:  25%|██▍       | 24723/100000 [00:05<00:14, 5364.24 examples/s]Map:  25%|██▌       | 25309/100000 [00:05<00:14, 5230.63 examples/s]Map:  26%|██▌       | 25947/100000 [00:05<00:13, 5520.78 examples/s]Map:  27%|██▋       | 26738/100000 [00:05<00:13, 5431.07 examples/s]Map:  27%|██▋       | 27311/100000 [00:05<00:13, 5286.08 examples/s]Map:  28%|██▊       | 27953/100000 [00:05<00:12, 5574.70 examples/s]Map:  29%|██▊       | 28697/100000 [00:05<00:13, 5352.31 examples/s]Map:  29%|██▉       | 29309/100000 [00:05<00:13, 5236.47 examples/s]Map:  30%|██▉       | 29949/100000 [00:06<00:12, 5529.52 examples/s]Map:  31%|███       | 30728/100000 [00:06<00:12, 5408.13 examples/s]Map:  31%|███▏      | 31319/100000 [00:06<00:17, 3879.56 examples/s]Map:  32%|███▏      | 31959/100000 [00:06<00:15, 4384.72 examples/s]Map:  33%|███▎      | 32724/100000 [00:06<00:14, 4597.40 examples/s]Map:  33%|███▎      | 33311/100000 [00:06<00:14, 4681.71 examples/s]Map:  34%|███▍      | 33952/100000 [00:06<00:12, 5084.13 examples/s]Map:  35%|███▍      | 34748/100000 [00:07<00:12, 5155.82 examples/s]Map:  35%|███▌      | 35311/100000 [00:07<00:12, 5081.92 examples/s]Map:  36%|███▌      | 35947/100000 [00:07<00:11, 5398.90 examples/s]Map:  37%|███▋      | 36725/100000 [00:07<00:11, 5320.79 examples/s]Map:  37%|███▋      | 37311/100000 [00:07<00:12, 5158.58 examples/s]Map:  38%|███▊      | 37954/100000 [00:07<00:11, 5476.49 examples/s]Map:  39%|███▊      | 38746/100000 [00:07<00:11, 5406.40 examples/s]Map:  39%|███▉      | 39312/100000 [00:07<00:11, 5267.53 examples/s]Map:  40%|███▉      | 39957/100000 [00:08<00:10, 5567.72 examples/s]Map:  41%|████      | 40742/100000 [00:08<00:10, 5445.57 examples/s]Map:  41%|████▏     | 41311/100000 [00:08<00:11, 5301.69 examples/s]Map:  42%|████▏     | 41955/100000 [00:08<00:10, 5591.29 examples/s]Map:  43%|████▎     | 42737/100000 [00:08<00:10, 5453.24 examples/s]Map:  43%|████▎     | 43309/100000 [00:08<00:10, 5239.67 examples/s]Map:  44%|████▍     | 43947/100000 [00:08<00:10, 5526.94 examples/s]Map:  45%|████▍     | 44740/100000 [00:08<00:10, 5440.69 examples/s]Map:  45%|████▌     | 45312/100000 [00:09<00:10, 5294.37 examples/s]Map:  46%|████▌     | 45860/100000 [00:09<00:13, 3996.84 examples/s]Map:  46%|████▋     | 46310/100000 [00:09<00:13, 4065.50 examples/s]Map:  47%|████▋     | 46955/100000 [00:09<00:11, 4621.07 examples/s]Map:  48%|████▊     | 47739/100000 [00:09<00:10, 4819.82 examples/s]Map:  48%|████▊     | 48310/100000 [00:09<00:10, 4847.57 examples/s]Map:  49%|████▉     | 48952/100000 [00:09<00:09, 5236.23 examples/s]Map:  50%|████▉     | 49711/100000 [00:09<00:09, 5171.29 examples/s]Map:  50%|█████     | 50309/100000 [00:10<00:09, 5101.65 examples/s]Map:  51%|█████     | 50945/100000 [00:10<00:09, 5417.05 examples/s]Map:  52%|█████▏    | 51722/100000 [00:10<00:09, 5330.53 examples/s]Map:  52%|█████▏    | 52312/100000 [00:10<00:09, 5229.44 examples/s]Map:  53%|█████▎    | 52951/100000 [00:10<00:08, 5521.26 examples/s]Map:  54%|█████▎    | 53726/100000 [00:10<00:08, 5391.88 examples/s]Map:  54%|█████▍    | 54312/100000 [00:10<00:08, 5264.59 examples/s]Map:  55%|█████▍    | 54953/100000 [00:10<00:08, 5555.27 examples/s]Map:  56%|█████▌    | 55742/100000 [00:11<00:08, 5447.66 examples/s]Map:  56%|█████▋    | 56310/100000 [00:11<00:08, 5293.22 examples/s]Map:  57%|█████▋    | 56950/100000 [00:11<00:07, 5575.54 examples/s]Map:  58%|█████▊    | 57625/100000 [00:11<00:09, 4357.71 examples/s]Map:  58%|█████▊    | 58405/100000 [00:11<00:09, 4606.65 examples/s]Map:  59%|█████▉    | 59000/100000 [00:11<00:08, 4710.39 examples/s]Map:  60%|█████▉    | 59634/100000 [00:11<00:07, 5088.16 examples/s]Map:  60%|██████    | 60406/100000 [00:12<00:07, 5105.23 examples/s]Map:  61%|██████    | 61000/100000 [00:12<00:10, 3760.36 examples/s]Map:  62%|██████▏   | 61626/100000 [00:12<00:09, 4249.89 examples/s]Map:  62%|██████▏   | 62415/100000 [00:12<00:08, 4547.62 examples/s]Map:  63%|██████▎   | 63000/100000 [00:12<00:07, 4656.77 examples/s]Map:  64%|██████▎   | 63621/100000 [00:12<00:07, 5016.60 examples/s]Map:  64%|██████▍   | 64384/100000 [00:12<00:07, 5037.84 examples/s]Map:  65%|██████▌   | 65000/100000 [00:13<00:06, 5039.26 examples/s]Map:  66%|██████▌   | 65631/100000 [00:13<00:06, 5349.89 examples/s]Map:  66%|██████▋   | 66422/100000 [00:13<00:06, 5320.11 examples/s]Map:  67%|██████▋   | 67000/100000 [00:13<00:06, 5232.57 examples/s]Map:  68%|██████▊   | 67633/100000 [00:13<00:05, 5509.56 examples/s]Map:  68%|██████▊   | 68423/100000 [00:13<00:05, 5420.56 examples/s]Map:  69%|██████▉   | 69000/100000 [00:13<00:05, 5235.16 examples/s]Map:  70%|██████▉   | 69624/100000 [00:13<00:05, 5489.47 examples/s]Map:  70%|███████   | 70404/100000 [00:14<00:05, 5384.67 examples/s]Map:  71%|███████   | 71000/100000 [00:14<00:05, 5274.25 examples/s]Map:  72%|███████▏  | 71629/100000 [00:14<00:05, 5531.95 examples/s]Map:  72%|███████▏  | 72418/100000 [00:14<00:05, 5432.33 examples/s]Map:  73%|███████▎  | 73000/100000 [00:14<00:05, 5294.09 examples/s]Map:  74%|███████▎  | 73632/100000 [00:14<00:04, 5553.23 examples/s]Map:  74%|███████▍  | 74391/100000 [00:14<00:04, 5376.22 examples/s]Map:  75%|███████▌  | 75000/100000 [00:14<00:04, 5242.04 examples/s]Map:  76%|███████▌  | 75834/100000 [00:15<00:05, 4157.88 examples/s]Map:  76%|███████▋  | 76311/100000 [00:15<00:05, 4237.62 examples/s]Map:  77%|███████▋  | 76952/100000 [00:15<00:04, 4715.46 examples/s]Map:  78%|███████▊  | 77739/100000 [00:15<00:04, 4883.62 examples/s]Map:  78%|███████▊  | 78308/100000 [00:15<00:04, 4842.49 examples/s]Map:  79%|███████▉  | 78942/100000 [00:15<00:04, 5203.26 examples/s]Map:  80%|███████▉  | 79719/100000 [00:15<00:03, 5194.64 examples/s]Map:  80%|████████  | 80312/100000 [00:16<00:03, 5127.48 examples/s]Map:  81%|████████  | 80954/100000 [00:16<00:03, 5448.65 examples/s]Map:  82%|████████▏ | 81744/100000 [00:16<00:03, 5380.57 examples/s]Map:  82%|████████▏ | 82311/100000 [00:16<00:03, 5196.91 examples/s]Map:  83%|████████▎ | 82951/100000 [00:16<00:03, 5499.34 examples/s]Map:  84%|████████▎ | 83740/100000 [00:16<00:03, 5413.09 examples/s]Map:  84%|████████▍ | 84309/100000 [00:16<00:02, 5267.10 examples/s]Map:  85%|████████▍ | 84951/100000 [00:16<00:02, 5560.16 examples/s]Map:  86%|████████▌ | 85715/100000 [00:17<00:02, 5391.40 examples/s]Map:  86%|████████▋ | 86311/100000 [00:17<00:02, 5268.75 examples/s]Map:  87%|████████▋ | 86952/100000 [00:17<00:02, 5559.55 examples/s]Map:  88%|████████▊ | 87742/100000 [00:17<00:02, 5454.45 examples/s]Map:  88%|████████▊ | 88313/100000 [00:17<00:02, 5303.91 examples/s]Map:  89%|████████▉ | 88954/100000 [00:17<00:01, 5584.38 examples/s]Map:  90%|████████▉ | 89744/100000 [00:17<00:01, 5468.59 examples/s]Map:  90%|█████████ | 90307/100000 [00:18<00:02, 3868.63 examples/s]Map:  91%|█████████ | 90943/100000 [00:18<00:02, 4370.70 examples/s]Map:  92%|█████████▏| 91716/100000 [00:18<00:01, 4603.88 examples/s]Map:  92%|█████████▏| 92309/100000 [00:18<00:01, 4689.38 examples/s]Map:  93%|█████████▎| 92944/100000 [00:18<00:01, 5076.13 examples/s]Map:  94%|█████████▎| 93739/100000 [00:18<00:01, 5149.37 examples/s]Map:  94%|█████████▍| 94310/100000 [00:18<00:01, 5081.13 examples/s]Map:  95%|█████████▍| 94948/100000 [00:18<00:00, 5402.31 examples/s]Map:  96%|█████████▌| 95721/100000 [00:19<00:00, 5312.92 examples/s]Map:  96%|█████████▋| 96311/100000 [00:19<00:00, 5206.49 examples/s]Map:  97%|█████████▋| 96952/100000 [00:19<00:00, 5507.69 examples/s]Map:  98%|█████████▊| 97742/100000 [00:19<00:00, 5419.90 examples/s]Map:  98%|█████████▊| 98309/100000 [00:19<00:00, 5269.21 examples/s]Map:  99%|█████████▉| 98950/100000 [00:19<00:00, 5560.49 examples/s]Map: 100%|█████████▉| 99734/100000 [00:19<00:00, 5439.78 examples/s]Map: 100%|██████████| 100000/100000 [00:19<00:00, 5039.36 examples/s]
Map:   0%|          | 0/10000 [00:00<?, ? examples/s]Map:   6%|▋         | 639/10000 [00:00<00:01, 6324.22 examples/s]Map:  14%|█▍        | 1383/10000 [00:00<00:01, 5386.78 examples/s]Map:  20%|██        | 2000/10000 [00:00<00:01, 5218.64 examples/s]Map:  26%|██▋       | 2635/10000 [00:00<00:01, 5597.40 examples/s]Map:  34%|███▍      | 3414/10000 [00:00<00:01, 5423.88 examples/s]Map:  40%|████      | 4000/10000 [00:00<00:01, 5061.46 examples/s]Map:  46%|████▋     | 4627/10000 [00:00<00:00, 5386.68 examples/s]Map:  53%|█████▎    | 5309/10000 [00:01<00:01, 3797.23 examples/s]Map:  60%|█████▉    | 5951/10000 [00:01<00:00, 4340.33 examples/s]Map:  67%|██████▋   | 6737/10000 [00:01<00:00, 4615.05 examples/s]Map:  73%|███████▎  | 7309/10000 [00:01<00:00, 4648.45 examples/s]Map:  80%|███████▉  | 7955/10000 [00:01<00:00, 5074.70 examples/s]Map:  86%|████████▋ | 8629/10000 [00:01<00:00, 4791.89 examples/s]Map:  94%|█████████▍| 9395/10000 [00:01<00:00, 4890.40 examples/s]Map: 100%|██████████| 10000/10000 [00:02<00:00, 4928.67 examples/s]Map: 100%|██████████| 10000/10000 [00:02<00:00, 4879.26 examples/s]
/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/sum/ufj45ra/faithful_reasoning/ft_unsloth_llama3.py", line 166, in <module>
    trainer = SFTTrainer(
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/trl/trainer/sft_trainer.py", line 189, in __init__
    if args.packing and data_collator is not None and isinstance(data_collator, DataCollatorForCompletionOnlyLM):
AttributeError: 'TrainingArguments' object has no attribute 'packing'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Not an error, but Unsloth cannot patch Attention layers with our manual autograd engine since either LoRA adapters
are not enabled or a bias term (like in Qwen) is used.
Unsloth 2024.5 patched 32 layers with 0 QKV layers, 32 O layers and 32 MLP layers.
Map:   0%|          | 0/100000 [00:00<?, ? examples/s]Map:   0%|          | 1/100000 [00:00<6:41:35,  4.15 examples/s]Map:   1%|          | 631/100000 [00:00<00:42, 2346.20 examples/s]Map:   1%|          | 1056/100000 [00:00<00:32, 3003.68 examples/s]Map:   2%|▏         | 1710/100000 [00:00<00:23, 4173.64 examples/s]Map:   2%|▏         | 2312/100000 [00:00<00:31, 3076.34 examples/s]Map:   3%|▎         | 2957/100000 [00:00<00:25, 3845.36 examples/s]Map:   4%|▎         | 3732/100000 [00:01<00:22, 4276.81 examples/s]Map:   4%|▍         | 4314/100000 [00:01<00:21, 4464.84 examples/s]Map:   5%|▍         | 4961/100000 [00:01<00:19, 4957.07 examples/s]Map:   6%|▌         | 5773/100000 [00:01<00:18, 5112.14 examples/s]Map:   7%|▋         | 6636/100000 [00:01<00:18, 5073.70 examples/s]Map:   7%|▋         | 7440/100000 [00:01<00:17, 5160.51 examples/s]Map:   8%|▊         | 8000/100000 [00:01<00:17, 5146.44 examples/s]Map:   9%|▊         | 8641/100000 [00:01<00:16, 5449.19 examples/s]Map:   9%|▉         | 9454/100000 [00:02<00:16, 5437.00 examples/s]Map:  10%|█         | 10313/100000 [00:02<00:16, 5434.80 examples/s]Map:  11%|█         | 10958/100000 [00:02<00:15, 5671.16 examples/s]Map:  12%|█▏        | 11763/100000 [00:02<00:15, 5567.66 examples/s]Map:  13%|█▎        | 12638/100000 [00:02<00:16, 5370.78 examples/s]Map:  13%|█▎        | 13444/100000 [00:02<00:16, 5368.17 examples/s]Map:  14%|█▍        | 14000/100000 [00:02<00:16, 5268.37 examples/s]Map:  15%|█▍        | 14642/100000 [00:03<00:15, 5540.49 examples/s]Map:  15%|█▌        | 15456/100000 [00:03<00:15, 5500.22 examples/s]Map:  16%|█▋        | 16313/100000 [00:03<00:15, 5479.42 examples/s]Map:  17%|█▋        | 16922/100000 [00:03<00:19, 4229.98 examples/s]Map:  18%|█▊        | 17709/100000 [00:03<00:18, 4506.41 examples/s]Map:  18%|█▊        | 18313/100000 [00:03<00:17, 4644.79 examples/s]Map:  19%|█▉        | 18962/100000 [00:03<00:16, 5050.77 examples/s]Map:  20%|█▉        | 19774/100000 [00:04<00:15, 5165.12 examples/s]Map:  20%|██        | 20313/100000 [00:04<00:15, 5124.41 examples/s]Map:  21%|██        | 20962/100000 [00:04<00:14, 5459.24 examples/s]Map:  22%|██▏       | 21758/100000 [00:04<00:14, 5401.87 examples/s]Map:  22%|██▏       | 22315/100000 [00:04<00:14, 5300.92 examples/s]Map:  23%|██▎       | 22968/100000 [00:04<00:13, 5614.50 examples/s]Map:  24%|██▍       | 23777/100000 [00:04<00:13, 5533.24 examples/s]Map:  25%|██▍       | 24639/100000 [00:05<00:13, 5510.85 examples/s]Map:  25%|██▌       | 25451/100000 [00:05<00:13, 5476.61 examples/s]Map:  26%|██▋       | 26312/100000 [00:05<00:13, 5433.51 examples/s]Map:  27%|██▋       | 26954/100000 [00:05<00:12, 5655.53 examples/s]Map:  28%|██▊       | 27766/100000 [00:05<00:12, 5575.36 examples/s]Map:  29%|██▊       | 28640/100000 [00:05<00:12, 5545.75 examples/s]Map:  29%|██▉       | 29458/100000 [00:05<00:12, 5513.68 examples/s]Map:  30%|███       | 30314/100000 [00:06<00:12, 5498.50 examples/s]Map:  31%|███       | 30958/100000 [00:06<00:12, 5707.13 examples/s]Map:  32%|███▏      | 31633/100000 [00:06<00:16, 4141.53 examples/s]Map:  32%|███▏      | 32114/100000 [00:06<00:15, 4269.16 examples/s]Map:  33%|███▎      | 32760/100000 [00:06<00:14, 4742.94 examples/s]Map:  33%|███▎      | 33316/100000 [00:06<00:13, 4814.46 examples/s]Map:  34%|███▍      | 33966/100000 [00:06<00:12, 5229.31 examples/s]Map:  35%|███▍      | 34783/100000 [00:06<00:12, 5300.96 examples/s]Map:  36%|███▌      | 35636/100000 [00:07<00:12, 5347.69 examples/s]Map:  36%|███▋      | 36449/100000 [00:07<00:11, 5366.26 examples/s]Map:  37%|███▋      | 37000/100000 [00:07<00:12, 5246.59 examples/s]Map:  38%|███▊      | 37640/100000 [00:07<00:11, 5524.43 examples/s]Map:  38%|███▊      | 38452/100000 [00:07<00:11, 5484.06 examples/s]Map:  39%|███▉      | 39312/100000 [00:07<00:11, 5469.29 examples/s]Map:  40%|███▉      | 39960/100000 [00:07<00:10, 5705.84 examples/s]Map:  41%|████      | 40775/100000 [00:08<00:10, 5610.52 examples/s]Map:  42%|████▏     | 41639/100000 [00:08<00:10, 5567.35 examples/s]Map:  42%|████▏     | 42448/100000 [00:08<00:10, 5511.07 examples/s]Map:  43%|████▎     | 43315/100000 [00:08<00:10, 5478.49 examples/s]Map:  44%|████▍     | 43962/100000 [00:08<00:09, 5697.89 examples/s]Map:  45%|████▍     | 44779/100000 [00:08<00:09, 5614.19 examples/s]Map:  46%|████▌     | 45642/100000 [00:08<00:09, 5570.18 examples/s]Map:  46%|████▋     | 46308/100000 [00:09<00:14, 3821.79 examples/s]Map:  47%|████▋     | 46954/100000 [00:09<00:12, 4286.65 examples/s]Map:  48%|████▊     | 47753/100000 [00:09<00:11, 4568.84 examples/s]Map:  48%|████▊     | 48315/100000 [00:09<00:11, 4677.39 examples/s]Map:  49%|████▉     | 48965/100000 [00:09<00:10, 5085.08 examples/s]Map:  50%|████▉     | 49769/100000 [00:09<00:09, 5172.39 examples/s]Map:  51%|█████     | 50642/100000 [00:10<00:09, 5278.96 examples/s]Map:  51%|█████▏    | 51453/100000 [00:10<00:09, 5316.29 examples/s]Map:  52%|█████▏    | 52000/100000 [00:10<00:09, 5255.23 examples/s]Map:  53%|█████▎    | 52639/100000 [00:10<00:08, 5527.46 examples/s]Map:  53%|█████▎    | 53447/100000 [00:10<00:08, 5476.52 examples/s]Map:  54%|█████▍    | 54314/100000 [00:10<00:08, 5461.09 examples/s]Map:  55%|█████▍    | 54962/100000 [00:10<00:07, 5696.65 examples/s]Map:  56%|█████▌    | 55760/100000 [00:10<00:07, 5568.55 examples/s]Map:  57%|█████▋    | 56641/100000 [00:11<00:07, 5541.98 examples/s]Map:  57%|█████▋    | 57453/100000 [00:11<00:07, 5500.15 examples/s]Map:  58%|█████▊    | 58314/100000 [00:11<00:07, 5495.65 examples/s]Map:  59%|█████▉    | 58967/100000 [00:11<00:07, 5726.34 examples/s]Map:  60%|█████▉    | 59773/100000 [00:11<00:07, 5611.20 examples/s]Map:  61%|██████    | 60629/100000 [00:11<00:07, 5542.79 examples/s]Map:  61%|██████▏   | 61312/100000 [00:12<00:09, 4109.17 examples/s]Map:  62%|██████▏   | 61960/100000 [00:12<00:08, 4551.00 examples/s]Map:  63%|██████▎   | 62774/100000 [00:12<00:07, 4798.45 examples/s]Map:  63%|██████▎   | 63315/100000 [00:12<00:07, 4844.61 examples/s]Map:  64%|██████▍   | 63967/100000 [00:12<00:06, 5229.81 examples/s]Map:  65%|██████▍   | 64778/100000 [00:12<00:06, 5286.67 examples/s]Map:  66%|██████▌   | 65637/100000 [00:12<00:06, 5342.51 examples/s]Map:  66%|██████▋   | 66450/100000 [00:13<00:06, 5363.23 examples/s]Map:  67%|██████▋   | 67000/100000 [00:13<00:06, 5262.58 examples/s]Map:  68%|██████▊   | 67631/100000 [00:13<00:05, 5514.30 examples/s]Map:  68%|██████▊   | 68433/100000 [00:13<00:05, 5454.70 examples/s]Map:  69%|██████▉   | 69000/100000 [00:13<00:05, 5361.44 examples/s]Map:  70%|██████▉   | 69641/100000 [00:13<00:05, 5627.29 examples/s]Map:  70%|███████   | 70456/100000 [00:13<00:05, 5556.99 examples/s]Map:  71%|███████▏  | 71321/100000 [00:13<00:05, 5531.52 examples/s]Map:  72%|███████▏  | 71966/100000 [00:14<00:04, 5749.43 examples/s]Map:  73%|███████▎  | 72775/100000 [00:14<00:04, 5626.95 examples/s]Map:  74%|███████▎  | 73636/100000 [00:14<00:04, 5534.76 examples/s]Map:  74%|███████▍  | 74446/100000 [00:14<00:04, 5489.58 examples/s]Map:  75%|███████▌  | 75000/100000 [00:14<00:04, 5369.10 examples/s]Map:  76%|███████▌  | 75837/100000 [00:14<00:05, 4268.64 examples/s]Map:  76%|███████▋  | 76315/100000 [00:14<00:05, 4351.23 examples/s]Map:  77%|███████▋  | 76963/100000 [00:15<00:04, 4811.61 examples/s]Map:  78%|███████▊  | 77778/100000 [00:15<00:04, 5006.56 examples/s]Map:  78%|███████▊  | 78315/100000 [00:15<00:04, 4997.86 examples/s]Map:  79%|███████▉  | 78962/100000 [00:15<00:03, 5356.97 examples/s]Map:  80%|███████▉  | 79774/100000 [00:15<00:03, 5374.94 examples/s]Map:  81%|████████  | 80633/100000 [00:15<00:03, 5387.79 examples/s]Map:  81%|████████▏ | 81448/100000 [00:15<00:03, 5399.31 examples/s]Map:  82%|████████▏ | 82000/100000 [00:15<00:03, 5311.98 examples/s]Map:  83%|████████▎ | 82639/100000 [00:16<00:03, 5572.53 examples/s]Map:  83%|████████▎ | 83454/100000 [00:16<00:02, 5523.20 examples/s]Map:  84%|████████▍ | 84314/100000 [00:16<00:02, 5494.23 examples/s]Map:  85%|████████▍ | 84964/100000 [00:16<00:02, 5727.94 examples/s]Map:  86%|████████▌ | 85772/100000 [00:16<00:02, 5611.40 examples/s]Map:  87%|████████▋ | 86641/100000 [00:16<00:02, 5578.63 examples/s]Map:  87%|████████▋ | 87445/100000 [00:16<00:02, 5507.61 examples/s]Map:  88%|████████▊ | 88316/100000 [00:17<00:02, 5492.58 examples/s]Map:  89%|████████▉ | 88966/100000 [00:17<00:01, 5716.19 examples/s]Map:  90%|████████▉ | 89783/100000 [00:17<00:01, 5627.31 examples/s]Map:  91%|█████████ | 90636/100000 [00:17<00:02, 4222.95 examples/s]Map:  91%|█████████ | 91119/100000 [00:17<00:02, 4333.47 examples/s]Map:  92%|█████████▏| 91768/100000 [00:17<00:01, 4780.62 examples/s]Map:  92%|█████████▏| 92315/100000 [00:17<00:01, 4832.68 examples/s]Map:  93%|█████████▎| 92965/100000 [00:18<00:01, 5234.84 examples/s]Map:  94%|█████████▎| 93640/100000 [00:18<00:01, 4257.43 examples/s]Map:  94%|█████████▍| 94123/100000 [00:18<00:01, 4381.14 examples/s]Map:  95%|█████████▍| 94764/100000 [00:18<00:01, 4859.58 examples/s]Map:  95%|█████████▌| 95313/100000 [00:18<00:00, 4886.11 examples/s]Map:  96%|█████████▌| 95957/100000 [00:18<00:00, 5287.95 examples/s]Map:  97%|█████████▋| 96773/100000 [00:18<00:00, 5341.69 examples/s]Map:  98%|█████████▊| 97640/100000 [00:19<00:00, 5388.17 examples/s]Map:  98%|█████████▊| 98443/100000 [00:19<00:00, 5374.10 examples/s]Map:  99%|█████████▉| 99000/100000 [00:19<00:00, 5285.27 examples/s]Map: 100%|█████████▉| 99640/100000 [00:19<00:00, 5557.86 examples/s]Map: 100%|██████████| 100000/100000 [00:19<00:00, 5136.76 examples/s]
Map:   0%|          | 0/10000 [00:00<?, ? examples/s]Map:   6%|▋         | 643/10000 [00:00<00:01, 6364.18 examples/s]Map:  14%|█▍        | 1430/10000 [00:00<00:01, 5599.38 examples/s]Map:  23%|██▎       | 2315/10000 [00:00<00:01, 5547.32 examples/s]Map:  30%|██▉       | 2966/10000 [00:00<00:01, 5843.89 examples/s]Map:  37%|███▋      | 3716/10000 [00:00<00:01, 5503.96 examples/s]Map:  43%|████▎     | 4314/10000 [00:00<00:01, 5379.69 examples/s]Map:  50%|█████     | 5000/10000 [00:01<00:01, 3867.51 examples/s]Map:  56%|█████▋    | 5637/10000 [00:01<00:00, 4384.91 examples/s]Map:  64%|██████▎   | 6366/10000 [00:01<00:00, 4527.20 examples/s]Map:  70%|███████   | 7000/10000 [00:01<00:00, 4702.85 examples/s]Map:  76%|███████▋  | 7643/10000 [00:01<00:00, 5108.44 examples/s]Map:  84%|████████▍ | 8450/10000 [00:01<00:00, 5196.13 examples/s]Map:  90%|█████████ | 9000/10000 [00:01<00:00, 5162.18 examples/s]Map:  96%|█████████▋| 9650/10000 [00:01<00:00, 5498.01 examples/s]Map: 100%|██████████| 10000/10000 [00:01<00:00, 5068.67 examples/s]
/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/sum/ufj45ra/faithful_reasoning/ft_unsloth_llama3.py", line 166, in <module>
    trainer = SFTTrainer(
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/trl/trainer/sft_trainer.py", line 189, in __init__
    if args.packing and data_collator is not None and isinstance(data_collator, DataCollatorForCompletionOnlyLM):
AttributeError: 'TrainingArguments' object has no attribute 'packing'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Not an error, but Unsloth cannot patch Attention layers with our manual autograd engine since either LoRA adapters
are not enabled or a bias term (like in Qwen) is used.
Unsloth 2024.5 patched 32 layers with 0 QKV layers, 32 O layers and 32 MLP layers.
Map:   0%|          | 0/100000 [00:00<?, ? examples/s]Map:   0%|          | 1/100000 [00:00<7:06:33,  3.91 examples/s]Map:   1%|          | 612/100000 [00:00<00:45, 2190.55 examples/s]Map:   1%|          | 1001/100000 [00:00<00:35, 2752.96 examples/s]Map:   2%|▏         | 1644/100000 [00:00<00:24, 3944.68 examples/s]Map:   2%|▏         | 2307/100000 [00:00<00:32, 2983.98 examples/s]Map:   3%|▎         | 2942/100000 [00:00<00:26, 3722.27 examples/s]Map:   4%|▎         | 3721/100000 [00:01<00:22, 4190.69 examples/s]Map:   4%|▍         | 4309/100000 [00:01<00:22, 4248.84 examples/s]Map:   5%|▍         | 4939/100000 [00:01<00:20, 4732.76 examples/s]Map:   6%|▌         | 5688/100000 [00:01<00:19, 4817.72 examples/s]Map:   6%|▋         | 6309/100000 [00:01<00:19, 4835.23 examples/s]Map:   7%|▋         | 6946/100000 [00:01<00:17, 5208.45 examples/s]Map:   8%|▊         | 7631/100000 [00:01<00:18, 4947.93 examples/s]Map:   8%|▊         | 8411/100000 [00:02<00:18, 5028.01 examples/s]Map:   9%|▉         | 9000/100000 [00:02<00:18, 4985.03 examples/s]Map:  10%|▉         | 9627/100000 [00:02<00:17, 5296.52 examples/s]Map:  10%|█         | 10409/100000 [00:02<00:17, 5265.74 examples/s]Map:  11%|█         | 11000/100000 [00:02<00:17, 5184.97 examples/s]Map:  12%|█▏        | 11627/100000 [00:02<00:16, 5457.13 examples/s]Map:  12%|█▏        | 12409/100000 [00:02<00:16, 5366.23 examples/s]Map:  13%|█▎        | 13000/100000 [00:02<00:16, 5210.13 examples/s]Map:  14%|█▎        | 13629/100000 [00:02<00:15, 5481.96 examples/s]Map:  14%|█▍        | 14305/100000 [00:03<00:17, 4994.38 examples/s]Map:  15%|█▍        | 14932/100000 [00:03<00:16, 5306.54 examples/s]Map:  16%|█▌        | 15690/100000 [00:03<00:16, 5217.14 examples/s]Map:  16%|█▋        | 16311/100000 [00:03<00:16, 5142.79 examples/s]Map:  17%|█▋        | 16919/100000 [00:03<00:20, 3967.23 examples/s]Map:  18%|█▊        | 17670/100000 [00:03<00:19, 4260.17 examples/s]Map:  18%|█▊        | 18444/100000 [00:04<00:18, 4517.42 examples/s]Map:  19%|█▉        | 19000/100000 [00:04<00:17, 4585.74 examples/s]Map:  20%|█▉        | 19628/100000 [00:04<00:16, 4971.96 examples/s]Map:  20%|██        | 20398/100000 [00:04<00:15, 5022.86 examples/s]Map:  21%|██        | 21000/100000 [00:04<00:15, 4956.30 examples/s]Map:  22%|██▏       | 21626/100000 [00:04<00:14, 5272.67 examples/s]Map:  22%|██▏       | 22403/100000 [00:04<00:14, 5238.40 examples/s]Map:  23%|██▎       | 23000/100000 [00:04<00:15, 5118.21 examples/s]Map:  24%|██▎       | 23628/100000 [00:05<00:14, 5405.06 examples/s]Map:  24%|██▍       | 24401/100000 [00:05<00:14, 5314.21 examples/s]Map:  25%|██▌       | 25000/100000 [00:05<00:14, 5174.44 examples/s]Map:  26%|██▌       | 25621/100000 [00:05<00:13, 5432.84 examples/s]Map:  26%|██▋       | 26368/100000 [00:05<00:13, 5271.17 examples/s]Map:  27%|██▋       | 27000/100000 [00:05<00:14, 5150.05 examples/s]Map:  28%|██▊       | 27629/100000 [00:05<00:13, 5432.34 examples/s]Map:  28%|██▊       | 28403/100000 [00:05<00:13, 5335.31 examples/s]Map:  29%|██▉       | 29000/100000 [00:06<00:13, 5239.64 examples/s]Map:  30%|██▉       | 29628/100000 [00:06<00:12, 5502.30 examples/s]Map:  30%|███       | 30390/100000 [00:06<00:13, 5352.23 examples/s]Map:  31%|███       | 31000/100000 [00:06<00:17, 3880.16 examples/s]Map:  32%|███▏      | 31627/100000 [00:06<00:15, 4358.52 examples/s]Map:  32%|███▏      | 32414/100000 [00:06<00:14, 4620.22 examples/s]Map:  33%|███▎      | 33000/100000 [00:06<00:14, 4718.74 examples/s]Map:  34%|███▎      | 33631/100000 [00:07<00:13, 5090.48 examples/s]Map:  34%|███▍      | 34417/100000 [00:07<00:12, 5137.48 examples/s]Map:  35%|███▌      | 35000/100000 [00:07<00:12, 5076.53 examples/s]Map:  36%|███▌      | 35628/100000 [00:07<00:11, 5373.27 examples/s]Map:  36%|███▋      | 36408/100000 [00:07<00:11, 5309.17 examples/s]Map:  37%|███▋      | 37000/100000 [00:07<00:12, 5151.08 examples/s]Map:  38%|███▊      | 37631/100000 [00:07<00:11, 5439.46 examples/s]Map:  38%|███▊      | 38417/100000 [00:07<00:11, 5367.35 examples/s]Map:  39%|███▉      | 39000/100000 [00:08<00:11, 5257.80 examples/s]Map:  40%|███▉      | 39629/100000 [00:08<00:10, 5517.75 examples/s]Map:  40%|████      | 40414/100000 [00:08<00:11, 5416.13 examples/s]Map:  41%|████      | 41000/100000 [00:08<00:11, 5295.55 examples/s]Map:  42%|████▏     | 41625/100000 [00:08<00:10, 5539.60 examples/s]Map:  42%|████▏     | 42364/100000 [00:08<00:10, 5319.54 examples/s]Map:  43%|████▎     | 43000/100000 [00:08<00:10, 5244.29 examples/s]Map:  44%|████▎     | 43630/100000 [00:08<00:10, 5510.07 examples/s]Map:  44%|████▍     | 44414/100000 [00:09<00:10, 5406.56 examples/s]Map:  45%|████▌     | 45000/100000 [00:09<00:10, 5278.93 examples/s]Map:  46%|████▌     | 45629/100000 [00:09<00:09, 5534.90 examples/s]Map:  46%|████▋     | 46307/100000 [00:09<00:13, 3932.28 examples/s]Map:  47%|████▋     | 46948/100000 [00:09<00:11, 4435.97 examples/s]Map:  48%|████▊     | 47723/100000 [00:09<00:11, 4656.00 examples/s]Map:  48%|████▊     | 48310/100000 [00:09<00:10, 4719.01 examples/s]Map:  49%|████▉     | 48947/100000 [00:10<00:10, 5104.48 examples/s]Map:  50%|████▉     | 49704/100000 [00:10<00:09, 5081.96 examples/s]Map:  50%|█████     | 50311/100000 [00:10<00:09, 5046.97 examples/s]Map:  51%|█████     | 50939/100000 [00:10<00:09, 5348.54 examples/s]Map:  52%|█████▏    | 51727/100000 [00:10<00:09, 5313.20 examples/s]Map:  52%|█████▏    | 52312/100000 [00:10<00:09, 5199.41 examples/s]Map:  53%|█████▎    | 52951/100000 [00:10<00:08, 5497.62 examples/s]Map:  54%|█████▎    | 53736/100000 [00:10<00:08, 5403.25 examples/s]Map:  54%|█████▍    | 54310/100000 [00:11<00:08, 5242.80 examples/s]Map:  55%|█████▍    | 54950/100000 [00:11<00:08, 5535.19 examples/s]Map:  56%|█████▌    | 55624/100000 [00:11<00:10, 4339.68 examples/s]Map:  56%|█████▋    | 56367/100000 [00:11<00:09, 4519.83 examples/s]Map:  57%|█████▋    | 57000/100000 [00:11<00:09, 4665.52 examples/s]Map:  58%|█████▊    | 57634/100000 [00:11<00:08, 5049.00 examples/s]Map:  58%|█████▊    | 58413/100000 [00:11<00:08, 5093.65 examples/s]Map:  59%|█████▉    | 59000/100000 [00:12<00:08, 5060.31 examples/s]Map:  60%|█████▉    | 59630/100000 [00:12<00:07, 5365.39 examples/s]Map:  60%|██████    | 60410/100000 [00:12<00:07, 5304.02 examples/s]Map:  61%|██████    | 61000/100000 [00:12<00:10, 3821.14 examples/s]Map:  62%|██████▏   | 61627/100000 [00:12<00:08, 4306.29 examples/s]Map:  62%|██████▏   | 62416/100000 [00:12<00:08, 4589.05 examples/s]Map:  63%|██████▎   | 63000/100000 [00:12<00:07, 4693.07 examples/s]Map:  64%|██████▎   | 63629/100000 [00:12<00:07, 5064.57 examples/s]Map:  64%|██████▍   | 64411/100000 [00:13<00:06, 5111.40 examples/s]Map:  65%|██████▌   | 65000/100000 [00:13<00:06, 5043.35 examples/s]Map:  66%|██████▌   | 65628/100000 [00:13<00:06, 5346.08 examples/s]Map:  66%|██████▋   | 66411/100000 [00:13<00:06, 5300.89 examples/s]Map:  67%|██████▋   | 67000/100000 [00:13<00:06, 5142.71 examples/s]Map:  68%|██████▊   | 67632/100000 [00:13<00:05, 5434.95 examples/s]Map:  68%|██████▊   | 68414/100000 [00:13<00:05, 5355.03 examples/s]Map:  69%|██████▉   | 69000/100000 [00:14<00:05, 5246.80 examples/s]Map:  70%|██████▉   | 69631/100000 [00:14<00:05, 5515.41 examples/s]Map:  70%|███████   | 70410/100000 [00:14<00:05, 5397.15 examples/s]Map:  71%|███████   | 71000/100000 [00:14<00:05, 5280.30 examples/s]Map:  72%|███████▏  | 71632/100000 [00:14<00:05, 5543.33 examples/s]Map:  72%|███████▏  | 72415/100000 [00:14<00:05, 5425.75 examples/s]Map:  73%|███████▎  | 73000/100000 [00:14<00:05, 5284.09 examples/s]Map:  74%|███████▎  | 73626/100000 [00:14<00:04, 5531.80 examples/s]Map:  74%|███████▍  | 74411/100000 [00:14<00:04, 5420.58 examples/s]Map:  75%|███████▌  | 75000/100000 [00:15<00:04, 5243.23 examples/s]Map:  76%|███████▌  | 75831/100000 [00:15<00:05, 4138.11 examples/s]Map:  76%|███████▋  | 76306/100000 [00:15<00:05, 4208.55 examples/s]Map:  77%|███████▋  | 76942/100000 [00:15<00:04, 4678.97 examples/s]Map:  78%|███████▊  | 77726/100000 [00:15<00:04, 4853.53 examples/s]Map:  78%|███████▊  | 78310/100000 [00:15<00:04, 4837.54 examples/s]Map:  79%|███████▉  | 78944/100000 [00:15<00:04, 5196.41 examples/s]Map:  80%|███████▉  | 79702/100000 [00:16<00:03, 5145.35 examples/s]Map:  80%|████████  | 80309/100000 [00:16<00:03, 5091.60 examples/s]Map:  81%|████████  | 80946/100000 [00:16<00:03, 5407.22 examples/s]Map:  82%|████████▏ | 81735/100000 [00:16<00:03, 5352.62 examples/s]Map:  82%|████████▏ | 82310/100000 [00:16<00:03, 5216.57 examples/s]Map:  83%|████████▎ | 82950/100000 [00:16<00:03, 5514.58 examples/s]Map:  84%|████████▎ | 83732/100000 [00:16<00:03, 5406.43 examples/s]Map:  84%|████████▍ | 84304/100000 [00:16<00:02, 5245.92 examples/s]Map:  85%|████████▍ | 84943/100000 [00:17<00:02, 5537.79 examples/s]Map:  86%|████████▌ | 85692/100000 [00:17<00:02, 5340.85 examples/s]Map:  86%|████████▋ | 86311/100000 [00:17<00:02, 5236.17 examples/s]Map:  87%|████████▋ | 86954/100000 [00:17<00:02, 5537.27 examples/s]Map:  88%|████████▊ | 87720/100000 [00:17<00:02, 5381.78 examples/s]Map:  88%|████████▊ | 88310/100000 [00:17<00:02, 5252.29 examples/s]Map:  89%|████████▉ | 88946/100000 [00:17<00:01, 5531.89 examples/s]Map:  90%|████████▉ | 89733/100000 [00:17<00:01, 5428.49 examples/s]Map:  90%|█████████ | 90306/100000 [00:18<00:02, 3858.37 examples/s]Map:  91%|█████████ | 90939/100000 [00:18<00:02, 4354.94 examples/s]Map:  92%|█████████▏| 91720/100000 [00:18<00:01, 4609.07 examples/s]Map:  92%|█████████▏| 92311/100000 [00:18<00:01, 4681.24 examples/s]Map:  93%|█████████▎| 92952/100000 [00:18<00:01, 5081.04 examples/s]Map:  94%|█████████▎| 93725/100000 [00:18<00:01, 5102.11 examples/s]Map:  94%|█████████▍| 94309/100000 [00:18<00:01, 4991.01 examples/s]Map:  95%|█████████▍| 94946/100000 [00:19<00:00, 5327.21 examples/s]Map:  96%|█████████▌| 95723/100000 [00:19<00:00, 5274.13 examples/s]Map:  96%|█████████▋| 96309/100000 [00:19<00:00, 5167.17 examples/s]Map:  97%|█████████▋| 96947/100000 [00:19<00:00, 5468.76 examples/s]Map:  98%|█████████▊| 97731/100000 [00:19<00:00, 5380.39 examples/s]Map:  98%|█████████▊| 98310/100000 [00:19<00:00, 5247.63 examples/s]Map:  99%|█████████▉| 98947/100000 [00:19<00:00, 5529.74 examples/s]Map: 100%|█████████▉| 99694/100000 [00:19<00:00, 5334.09 examples/s]Map: 100%|██████████| 100000/100000 [00:20<00:00, 4984.53 examples/s]
Map:   0%|          | 0/10000 [00:00<?, ? examples/s]Map:   6%|▋         | 642/10000 [00:00<00:01, 6345.69 examples/s]Map:  14%|█▍        | 1395/10000 [00:00<00:01, 5440.19 examples/s]Map:  20%|██        | 2000/10000 [00:00<00:01, 5046.83 examples/s]Map:  26%|██▋       | 2643/10000 [00:00<00:01, 5505.45 examples/s]Map:  34%|███▍      | 3418/10000 [00:00<00:01, 5360.10 examples/s]Map:  40%|████      | 4000/10000 [00:00<00:01, 5045.20 examples/s]Map:  46%|████▋     | 4628/10000 [00:00<00:00, 5377.58 examples/s]Map:  53%|█████▎    | 5302/10000 [00:01<00:01, 3748.94 examples/s]Map:  59%|█████▉    | 5941/10000 [00:01<00:00, 4292.61 examples/s]Map:  67%|██████▋   | 6705/10000 [00:01<00:00, 4536.65 examples/s]Map:  73%|███████▎  | 7311/10000 [00:01<00:00, 4410.89 examples/s]Map:  80%|███████▉  | 7957/10000 [00:01<00:00, 4871.40 examples/s]Map:  87%|████████▋ | 8727/10000 [00:01<00:00, 4954.72 examples/s]Map:  93%|█████████▎| 9312/10000 [00:01<00:00, 4933.38 examples/s]Map: 100%|█████████▉| 9952/10000 [00:02<00:00, 5289.68 examples/s]Map: 100%|██████████| 10000/10000 [00:02<00:00, 4848.86 examples/s]
/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/sum/ufj45ra/faithful_reasoning/ft_unsloth_llama3.py", line 166, in <module>
    trainer = SFTTrainer(
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/trl/trainer/sft_trainer.py", line 189, in __init__
    if args.packing and data_collator is not None and isinstance(data_collator, DataCollatorForCompletionOnlyLM):
AttributeError: 'TrainingArguments' object has no attribute 'packing'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Not an error, but Unsloth cannot patch Attention layers with our manual autograd engine since either LoRA adapters
are not enabled or a bias term (like in Qwen) is used.
Unsloth 2024.5 patched 32 layers with 0 QKV layers, 32 O layers and 32 MLP layers.
Map:   0%|          | 0/100000 [00:00<?, ? examples/s]Map:   0%|          | 1/100000 [00:00<8:44:48,  3.18 examples/s]Map:   1%|          | 674/100000 [00:00<00:47, 2101.54 examples/s]Map:   1%|▏         | 1351/100000 [00:00<00:30, 3202.54 examples/s]Map:   2%|▏         | 1989/100000 [00:00<00:33, 2949.55 examples/s]Map:   2%|▏         | 2457/100000 [00:00<00:29, 3340.15 examples/s]Map:   3%|▎         | 3000/100000 [00:00<00:25, 3803.71 examples/s]Map:   4%|▎         | 3693/100000 [00:01<00:20, 4601.84 examples/s]Map:   4%|▍         | 4343/100000 [00:01<00:20, 4774.46 examples/s]Map:   5%|▌         | 5000/100000 [00:01<00:19, 4999.74 examples/s]Map:   6%|▌         | 5696/100000 [00:01<00:17, 5514.13 examples/s]Map:   6%|▋         | 6345/100000 [00:01<00:17, 5479.64 examples/s]Map:   7%|▋         | 7000/100000 [00:01<00:17, 5275.44 examples/s]Map:   8%|▊         | 7688/100000 [00:01<00:16, 5691.31 examples/s]Map:   8%|▊         | 8340/100000 [00:01<00:16, 5606.70 examples/s]Map:   9%|▉         | 9000/100000 [00:02<00:16, 5577.21 examples/s]Map:  10%|▉         | 9691/100000 [00:02<00:15, 5930.82 examples/s]Map:  10%|█         | 10341/100000 [00:02<00:15, 5774.97 examples/s]Map:  11%|█         | 11000/100000 [00:02<00:15, 5706.28 examples/s]Map:  12%|█▏        | 11691/100000 [00:02<00:14, 6029.54 examples/s]Map:  12%|█▏        | 12341/100000 [00:02<00:15, 5835.56 examples/s]Map:  13%|█▎        | 13000/100000 [00:02<00:15, 5518.90 examples/s]Map:  14%|█▎        | 13688/100000 [00:02<00:14, 5874.67 examples/s]Map:  14%|█▍        | 14338/100000 [00:02<00:14, 5722.86 examples/s]Map:  15%|█▌        | 15000/100000 [00:03<00:20, 4085.12 examples/s]Map:  16%|█▌        | 15685/100000 [00:03<00:18, 4661.60 examples/s]Map:  16%|█▋        | 16339/100000 [00:03<00:17, 4856.17 examples/s]Map:  17%|█▋        | 17000/100000 [00:03<00:16, 5016.74 examples/s]Map:  18%|█▊        | 17695/100000 [00:03<00:14, 5488.03 examples/s]Map:  18%|█▊        | 18338/100000 [00:03<00:14, 5461.91 examples/s]Map:  19%|█▉        | 19000/100000 [00:03<00:14, 5464.52 examples/s]Map:  20%|█▉        | 19694/100000 [00:04<00:13, 5846.14 examples/s]Map:  20%|██        | 20340/100000 [00:04<00:13, 5718.13 examples/s]Map:  21%|██        | 21000/100000 [00:04<00:14, 5641.86 examples/s]Map:  22%|██▏       | 21691/100000 [00:04<00:13, 5977.32 examples/s]Map:  22%|██▏       | 22339/100000 [00:04<00:13, 5798.92 examples/s]Map:  23%|██▎       | 23000/100000 [00:04<00:13, 5667.98 examples/s]Map:  24%|██▎       | 23690/100000 [00:04<00:12, 5993.95 examples/s]Map:  24%|██▍       | 24340/100000 [00:04<00:13, 5815.98 examples/s]Map:  25%|██▌       | 25000/100000 [00:04<00:13, 5711.25 examples/s]Map:  26%|██▌       | 25696/100000 [00:05<00:12, 6045.06 examples/s]Map:  26%|██▋       | 26340/100000 [00:05<00:12, 5845.88 examples/s]Map:  27%|██▋       | 27000/100000 [00:05<00:12, 5739.27 examples/s]Map:  28%|██▊       | 27685/100000 [00:05<00:16, 4341.06 examples/s]Map:  28%|██▊       | 28338/100000 [00:05<00:15, 4545.53 examples/s]Map:  29%|██▉       | 29000/100000 [00:05<00:14, 4769.49 examples/s]Map:  30%|██▉       | 29698/100000 [00:05<00:13, 5287.42 examples/s]Map:  30%|███       | 30338/100000 [00:05<00:13, 5315.57 examples/s]Map:  31%|███       | 31000/100000 [00:06<00:12, 5368.09 examples/s]Map:  32%|███▏      | 31687/100000 [00:06<00:11, 5752.41 examples/s]Map:  32%|███▏      | 32342/100000 [00:06<00:11, 5665.28 examples/s]Map:  33%|███▎      | 33000/100000 [00:06<00:11, 5626.73 examples/s]Map:  34%|███▎      | 33693/100000 [00:06<00:11, 5971.49 examples/s]Map:  34%|███▍      | 34340/100000 [00:06<00:11, 5747.67 examples/s]Map:  35%|███▌      | 35000/100000 [00:06<00:11, 5675.06 examples/s]Map:  36%|███▌      | 35695/100000 [00:06<00:10, 6015.57 examples/s]Map:  36%|███▋      | 36338/100000 [00:06<00:10, 5825.67 examples/s]Map:  37%|███▋      | 37000/100000 [00:07<00:11, 5719.17 examples/s]Map:  38%|███▊      | 37691/100000 [00:07<00:10, 6039.65 examples/s]Map:  38%|███▊      | 38339/100000 [00:07<00:10, 5835.54 examples/s]Map:  39%|███▉      | 39000/100000 [00:07<00:10, 5737.61 examples/s]Map:  40%|███▉      | 39687/100000 [00:07<00:09, 6042.00 examples/s]Map:  40%|████      | 40337/100000 [00:07<00:10, 5802.43 examples/s]Map:  41%|████      | 41040/100000 [00:07<00:14, 4129.94 examples/s]Map:  42%|████▏     | 41741/100000 [00:08<00:12, 4726.22 examples/s]Map:  42%|████▏     | 42340/100000 [00:08<00:11, 4867.93 examples/s]Map:  43%|████▎     | 43000/100000 [00:08<00:11, 5044.25 examples/s]Map:  44%|████▎     | 43688/100000 [00:08<00:10, 5496.94 examples/s]Map:  44%|████▍     | 44341/100000 [00:08<00:10, 5482.63 examples/s]Map:  45%|████▌     | 45000/100000 [00:08<00:10, 5455.99 examples/s]Map:  46%|████▌     | 45696/100000 [00:08<00:09, 5845.90 examples/s]Map:  46%|████▋     | 46338/100000 [00:08<00:09, 5698.16 examples/s]Map:  47%|████▋     | 47000/100000 [00:08<00:09, 5638.27 examples/s]Map:  48%|████▊     | 47694/100000 [00:09<00:08, 5984.64 examples/s]Map:  48%|████▊     | 48340/100000 [00:09<00:08, 5813.21 examples/s]Map:  49%|████▉     | 49000/100000 [00:09<00:08, 5719.28 examples/s]Map:  50%|████▉     | 49691/100000 [00:09<00:08, 6037.83 examples/s]Map:  50%|█████     | 50340/100000 [00:09<00:08, 5846.57 examples/s]Map:  51%|█████     | 51000/100000 [00:09<00:09, 5068.89 examples/s]Map:  52%|█████▏    | 51683/100000 [00:09<00:08, 5501.59 examples/s]Map:  52%|█████▏    | 52342/100000 [00:09<00:08, 5475.45 examples/s]Map:  53%|█████▎    | 53000/100000 [00:10<00:08, 5485.24 examples/s]Map:  54%|█████▎    | 53691/100000 [00:10<00:07, 5855.62 examples/s]Map:  54%|█████▍    | 54338/100000 [00:10<00:11, 4114.22 examples/s]Map:  55%|█████▌    | 55000/100000 [00:10<00:10, 4456.74 examples/s]Map:  56%|█████▌    | 55684/100000 [00:10<00:08, 4989.25 examples/s]Map:  56%|█████▋    | 56337/100000 [00:10<00:08, 5071.63 examples/s]Map:  57%|█████▋    | 57000/100000 [00:10<00:08, 5192.93 examples/s]Map:  58%|█████▊    | 57691/100000 [00:10<00:07, 5621.15 examples/s]Map:  58%|█████▊    | 58336/100000 [00:11<00:07, 5537.28 examples/s]Map:  59%|█████▉    | 59000/100000 [00:11<00:07, 5526.64 examples/s]Map:  60%|█████▉    | 59694/100000 [00:11<00:06, 5895.84 examples/s]Map:  60%|██████    | 60346/100000 [00:11<00:06, 5751.00 examples/s]Map:  61%|██████    | 61000/100000 [00:11<00:06, 5668.30 examples/s]Map:  62%|██████▏   | 61687/100000 [00:11<00:06, 5988.24 examples/s]Map:  62%|██████▏   | 62338/100000 [00:11<00:06, 5800.55 examples/s]Map:  63%|██████▎   | 63000/100000 [00:11<00:06, 5708.23 examples/s]Map:  64%|██████▎   | 63686/100000 [00:12<00:06, 6016.07 examples/s]Map:  64%|██████▍   | 64335/100000 [00:12<00:06, 5809.41 examples/s]Map:  65%|██████▌   | 65000/100000 [00:12<00:06, 5714.90 examples/s]Map:  66%|██████▌   | 65687/100000 [00:12<00:05, 6024.98 examples/s]Map:  66%|██████▋   | 66337/100000 [00:12<00:05, 5832.62 examples/s]Map:  67%|██████▋   | 67000/100000 [00:12<00:07, 4130.02 examples/s]Map:  68%|██████▊   | 67681/100000 [00:12<00:06, 4691.31 examples/s]Map:  68%|██████▊   | 68335/100000 [00:12<00:06, 4867.86 examples/s]Map:  69%|██████▉   | 69000/100000 [00:13<00:06, 5042.26 examples/s]Map:  70%|██████▉   | 69686/100000 [00:13<00:05, 5486.04 examples/s]Map:  70%|███████   | 70337/100000 [00:13<00:05, 5461.05 examples/s]Map:  71%|███████   | 71000/100000 [00:13<00:05, 5462.35 examples/s]Map:  72%|███████▏  | 71689/100000 [00:13<00:04, 5831.64 examples/s]Map:  72%|███████▏  | 72338/100000 [00:13<00:04, 5655.89 examples/s]Map:  73%|███████▎  | 73000/100000 [00:13<00:04, 5603.05 examples/s]Map:  74%|███████▎  | 73683/100000 [00:13<00:04, 5927.44 examples/s]Map:  74%|███████▍  | 74338/100000 [00:13<00:04, 5761.52 examples/s]Map:  75%|███████▌  | 75000/100000 [00:14<00:04, 5678.80 examples/s]Map:  76%|███████▌  | 75689/100000 [00:14<00:04, 6002.12 examples/s]Map:  76%|███████▋  | 76336/100000 [00:14<00:04, 5802.41 examples/s]Map:  77%|███████▋  | 77000/100000 [00:14<00:04, 5709.15 examples/s]Map:  78%|███████▊  | 77685/100000 [00:14<00:03, 6014.14 examples/s]Map:  78%|███████▊  | 78339/100000 [00:14<00:03, 5798.67 examples/s]Map:  79%|███████▉  | 79000/100000 [00:14<00:03, 5700.48 examples/s]Map:  80%|███████▉  | 79686/100000 [00:14<00:03, 6010.74 examples/s]Map:  80%|████████  | 80382/100000 [00:15<00:04, 4187.03 examples/s]Map:  81%|████████  | 81000/100000 [00:15<00:04, 4474.93 examples/s]Map:  82%|████████▏ | 81691/100000 [00:15<00:03, 5021.08 examples/s]Map:  82%|████████▏ | 82341/100000 [00:15<00:03, 5135.07 examples/s]Map:  83%|████████▎ | 83000/100000 [00:15<00:03, 5227.96 examples/s]Map:  84%|████████▎ | 83688/100000 [00:15<00:02, 5642.63 examples/s]Map:  84%|████████▍ | 84342/100000 [00:15<00:02, 5577.62 examples/s]Map:  85%|████████▌ | 85000/100000 [00:15<00:02, 5567.46 examples/s]Map:  86%|████████▌ | 85690/100000 [00:16<00:02, 5918.02 examples/s]Map:  86%|████████▋ | 86339/100000 [00:16<00:02, 5758.33 examples/s]Map:  87%|████████▋ | 87000/100000 [00:16<00:02, 5678.41 examples/s]Map:  88%|████████▊ | 87687/100000 [00:16<00:02, 5996.85 examples/s]Map:  88%|████████▊ | 88336/100000 [00:16<00:02, 5774.86 examples/s]Map:  89%|████████▉ | 89000/100000 [00:16<00:01, 5685.99 examples/s]Map:  90%|████████▉ | 89690/100000 [00:16<00:01, 6009.14 examples/s]Map:  90%|█████████ | 90337/100000 [00:16<00:01, 5816.62 examples/s]Map:  91%|█████████ | 91000/100000 [00:16<00:01, 5711.43 examples/s]Map:  92%|█████████▏| 91694/100000 [00:17<00:01, 6039.03 examples/s]Map:  92%|█████████▏| 92342/100000 [00:17<00:01, 5841.23 examples/s]Map:  93%|█████████▎| 93000/100000 [00:17<00:01, 4106.41 examples/s]Map:  94%|█████████▎| 93681/100000 [00:17<00:01, 4671.66 examples/s]Map:  94%|█████████▍| 94339/100000 [00:17<00:01, 4863.88 examples/s]Map:  95%|█████████▌| 95000/100000 [00:17<00:00, 5041.38 examples/s]Map:  96%|█████████▌| 95688/100000 [00:17<00:00, 5490.33 examples/s]Map:  96%|█████████▋| 96339/100000 [00:18<00:00, 5474.17 examples/s]Map:  97%|█████████▋| 97000/100000 [00:18<00:00, 5482.85 examples/s]Map:  98%|█████████▊| 97691/100000 [00:18<00:00, 5854.67 examples/s]Map:  98%|█████████▊| 98336/100000 [00:18<00:00, 5712.40 examples/s]Map:  99%|█████████▉| 99000/100000 [00:18<00:00, 5613.05 examples/s]Map: 100%|█████████▉| 99688/100000 [00:18<00:00, 5946.32 examples/s]Map: 100%|██████████| 100000/100000 [00:18<00:00, 5352.68 examples/s]
Map:   0%|          | 0/10000 [00:00<?, ? examples/s]Map:   7%|▋         | 701/10000 [00:00<00:01, 6937.92 examples/s]Map:  17%|█▋        | 1705/10000 [00:00<00:01, 6126.82 examples/s]Map:  23%|██▎       | 2342/10000 [00:00<00:01, 5815.68 examples/s]Map:  30%|███       | 3000/10000 [00:00<00:01, 5682.65 examples/s]Map:  37%|███▋      | 3689/10000 [00:00<00:01, 6048.89 examples/s]Map:  43%|████▎     | 4339/10000 [00:00<00:00, 5666.47 examples/s]Map:  50%|█████     | 5000/10000 [00:00<00:00, 5624.47 examples/s]Map:  57%|█████▋    | 5692/10000 [00:00<00:00, 5982.48 examples/s]Map:  63%|██████▎   | 6340/10000 [00:01<00:00, 4134.17 examples/s]Map:  70%|███████   | 7000/10000 [00:01<00:00, 4356.73 examples/s]Map:  77%|███████▋  | 7685/10000 [00:01<00:00, 4910.53 examples/s]Map:  83%|████████▎ | 8339/10000 [00:01<00:00, 5050.10 examples/s]Map:  90%|█████████ | 9000/10000 [00:01<00:00, 5143.47 examples/s]Map:  97%|█████████▋| 9690/10000 [00:01<00:00, 5581.89 examples/s]Map: 100%|██████████| 10000/10000 [00:01<00:00, 5311.55 examples/s]
/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/sum/ufj45ra/faithful_reasoning/ft_unsloth_llama3.py", line 166, in <module>
    trainer = SFTTrainer(
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/trl/trainer/sft_trainer.py", line 189, in __init__
    if args.packing and data_collator is not None and isinstance(data_collator, DataCollatorForCompletionOnlyLM):
AttributeError: 'TrainingArguments' object has no attribute 'packing'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Not an error, but Unsloth cannot patch Attention layers with our manual autograd engine since either LoRA adapters
are not enabled or a bias term (like in Qwen) is used.
Unsloth 2024.5 patched 32 layers with 0 QKV layers, 32 O layers and 32 MLP layers.
Map:   0%|          | 0/100000 [00:00<?, ? examples/s]Map:   0%|          | 1/100000 [00:00<7:46:52,  3.57 examples/s]Map:   1%|          | 676/100000 [00:00<00:43, 2281.20 examples/s]Map:   1%|▏         | 1339/100000 [00:00<00:30, 3280.64 examples/s]Map:   2%|▏         | 1989/100000 [00:00<00:32, 2992.85 examples/s]Map:   2%|▏         | 2435/100000 [00:00<00:29, 3327.04 examples/s]Map:   3%|▎         | 3000/100000 [00:00<00:25, 3788.07 examples/s]Map:   4%|▎         | 3685/100000 [00:01<00:21, 4565.61 examples/s]Map:   4%|▍         | 4341/100000 [00:01<00:20, 4611.27 examples/s]Map:   5%|▌         | 5000/100000 [00:01<00:19, 4843.65 examples/s]Map:   6%|▌         | 5693/100000 [00:01<00:17, 5379.44 examples/s]Map:   6%|▋         | 6338/100000 [00:01<00:17, 5311.30 examples/s]Map:   7%|▋         | 7000/100000 [00:01<00:17, 5273.73 examples/s]Map:   8%|▊         | 7687/100000 [00:01<00:16, 5686.73 examples/s]Map:   8%|▊         | 8335/100000 [00:01<00:17, 5190.82 examples/s]Map:   9%|▉         | 9000/100000 [00:02<00:17, 5190.49 examples/s]Map:  10%|▉         | 9688/100000 [00:02<00:16, 5615.59 examples/s]Map:  10%|█         | 10340/100000 [00:02<00:16, 5496.90 examples/s]Map:  11%|█         | 11000/100000 [00:02<00:16, 5452.93 examples/s]Map:  12%|█▏        | 11689/100000 [00:02<00:15, 5826.59 examples/s]Map:  12%|█▏        | 12340/100000 [00:02<00:15, 5648.47 examples/s]Map:  13%|█▎        | 13000/100000 [00:02<00:15, 5552.69 examples/s]Map:  14%|█▎        | 13693/100000 [00:02<00:14, 5916.35 examples/s]Map:  14%|█▍        | 14338/100000 [00:02<00:15, 5687.46 examples/s]Map:  15%|█▌        | 15000/100000 [00:03<00:21, 4045.56 examples/s]Map:  16%|█▌        | 15680/100000 [00:03<00:18, 4615.26 examples/s]Map:  16%|█▋        | 16334/100000 [00:03<00:17, 4760.75 examples/s]Map:  17%|█▋        | 17000/100000 [00:03<00:17, 4879.13 examples/s]Map:  18%|█▊        | 17689/100000 [00:03<00:15, 5357.74 examples/s]Map:  18%|█▊        | 18351/100000 [00:03<00:15, 5344.48 examples/s]Map:  19%|█▉        | 19000/100000 [00:03<00:15, 5357.73 examples/s]Map:  20%|█▉        | 19691/100000 [00:04<00:13, 5755.15 examples/s]Map:  20%|██        | 20339/100000 [00:04<00:14, 5609.48 examples/s]Map:  21%|██        | 21000/100000 [00:04<00:14, 5538.40 examples/s]Map:  22%|██▏       | 21685/100000 [00:04<00:13, 5881.43 examples/s]Map:  22%|██▏       | 22341/100000 [00:04<00:13, 5634.62 examples/s]Map:  23%|██▎       | 23000/100000 [00:04<00:13, 5562.81 examples/s]Map:  24%|██▎       | 23687/100000 [00:04<00:12, 5906.61 examples/s]Map:  24%|██▍       | 24340/100000 [00:04<00:13, 5688.16 examples/s]Map:  25%|██▌       | 25000/100000 [00:05<00:13, 5568.69 examples/s]Map:  26%|██▌       | 25689/100000 [00:05<00:12, 5917.38 examples/s]Map:  26%|██▋       | 26348/100000 [00:05<00:12, 5712.72 examples/s]Map:  27%|██▋       | 27000/100000 [00:05<00:13, 5605.48 examples/s]Map:  28%|██▊       | 27682/100000 [00:05<00:12, 5925.92 examples/s]Map:  28%|██▊       | 28337/100000 [00:05<00:17, 4094.84 examples/s]Map:  29%|██▉       | 29000/100000 [00:05<00:17, 3984.25 examples/s]Map:  30%|██▉       | 29683/100000 [00:06<00:15, 4565.19 examples/s]Map:  30%|███       | 30340/100000 [00:06<00:14, 4761.80 examples/s]Map:  31%|███       | 31000/100000 [00:06<00:13, 4931.81 examples/s]Map:  32%|███▏      | 31681/100000 [00:06<00:12, 5383.99 examples/s]Map:  32%|███▏      | 32337/100000 [00:06<00:12, 5346.48 examples/s]Map:  33%|███▎      | 33000/100000 [00:06<00:12, 5359.61 examples/s]Map:  34%|███▎      | 33688/100000 [00:06<00:11, 5749.99 examples/s]Map:  34%|███▍      | 34341/100000 [00:06<00:11, 5618.99 examples/s]Map:  35%|███▌      | 35000/100000 [00:06<00:11, 5512.18 examples/s]Map:  36%|███▌      | 35688/100000 [00:07<00:10, 5867.94 examples/s]Map:  36%|███▋      | 36339/100000 [00:07<00:11, 5687.93 examples/s]Map:  37%|███▋      | 37000/100000 [00:07<00:11, 5559.23 examples/s]Map:  38%|███▊      | 37691/100000 [00:07<00:10, 5912.07 examples/s]Map:  38%|███▊      | 38339/100000 [00:07<00:10, 5721.97 examples/s]Map:  39%|███▉      | 39000/100000 [00:07<00:11, 5537.31 examples/s]Map:  40%|███▉      | 39682/100000 [00:07<00:10, 5872.28 examples/s]Map:  40%|████      | 40341/100000 [00:07<00:10, 5697.93 examples/s]Map:  41%|████      | 41022/100000 [00:08<00:14, 4059.08 examples/s]Map:  42%|████▏     | 41722/100000 [00:08<00:12, 4663.93 examples/s]Map:  42%|████▏     | 42341/100000 [00:08<00:11, 4806.97 examples/s]Map:  43%|████▎     | 43000/100000 [00:08<00:11, 4968.48 examples/s]Map:  44%|████▎     | 43689/100000 [00:08<00:10, 5435.88 examples/s]Map:  44%|████▍     | 44338/100000 [00:08<00:10, 5385.00 examples/s]Map:  45%|████▌     | 45000/100000 [00:08<00:10, 5373.60 examples/s]Map:  46%|████▌     | 45688/100000 [00:08<00:09, 5761.23 examples/s]Map:  46%|████▋     | 46340/100000 [00:09<00:09, 5599.44 examples/s]Map:  47%|████▋     | 47000/100000 [00:09<00:09, 5511.69 examples/s]Map:  48%|████▊     | 47691/100000 [00:09<00:08, 5876.31 examples/s]Map:  48%|████▊     | 48341/100000 [00:09<00:09, 5703.48 examples/s]Map:  49%|████▉     | 49000/100000 [00:09<00:09, 5611.92 examples/s]Map:  50%|████▉     | 49694/100000 [00:09<00:08, 5962.18 examples/s]Map:  50%|█████     | 50339/100000 [00:09<00:08, 5757.22 examples/s]Map:  51%|█████     | 51000/100000 [00:09<00:08, 5649.27 examples/s]Map:  52%|█████▏    | 51685/100000 [00:09<00:08, 5963.72 examples/s]Map:  52%|█████▏    | 52340/100000 [00:10<00:08, 5712.08 examples/s]Map:  53%|█████▎    | 53000/100000 [00:10<00:08, 5608.50 examples/s]Map:  54%|█████▎    | 53694/100000 [00:10<00:07, 5960.40 examples/s]Map:  54%|█████▍    | 54337/100000 [00:10<00:11, 4130.03 examples/s]Map:  55%|█████▌    | 55000/100000 [00:10<00:10, 4406.35 examples/s]Map:  56%|█████▌    | 55690/100000 [00:10<00:08, 4956.08 examples/s]Map:  56%|█████▋    | 56340/100000 [00:10<00:08, 5048.93 examples/s]Map:  57%|█████▋    | 57000/100000 [00:11<00:08, 5151.58 examples/s]Map:  58%|█████▊    | 57692/100000 [00:11<00:07, 5590.98 examples/s]Map:  58%|█████▊    | 58333/100000 [00:11<00:09, 4410.14 examples/s]Map:  59%|█████▉    | 59000/100000 [00:11<00:08, 4660.66 examples/s]Map:  60%|█████▉    | 59694/100000 [00:11<00:07, 5185.02 examples/s]Map:  60%|██████    | 60340/100000 [00:11<00:07, 5206.20 examples/s]Map:  61%|██████    | 61000/100000 [00:11<00:07, 5262.96 examples/s]Map:  62%|██████▏   | 61689/100000 [00:11<00:06, 5673.15 examples/s]Map:  62%|██████▏   | 62338/100000 [00:12<00:06, 5563.59 examples/s]Map:  63%|██████▎   | 63000/100000 [00:12<00:06, 5505.17 examples/s]Map:  64%|██████▎   | 63691/100000 [00:12<00:06, 5871.74 examples/s]Map:  64%|██████▍   | 64339/100000 [00:12<00:06, 5666.36 examples/s]Map:  65%|██████▌   | 65000/100000 [00:12<00:06, 5583.74 examples/s]Map:  66%|██████▌   | 65690/100000 [00:12<00:05, 5930.25 examples/s]Map:  66%|██████▋   | 66341/100000 [00:12<00:05, 5740.46 examples/s]Map:  67%|██████▋   | 67000/100000 [00:13<00:08, 4058.70 examples/s]Map:  68%|██████▊   | 67685/100000 [00:13<00:06, 4638.18 examples/s]Map:  68%|██████▊   | 68338/100000 [00:13<00:06, 4807.93 examples/s]Map:  69%|██████▉   | 69000/100000 [00:13<00:06, 4938.10 examples/s]Map:  70%|██████▉   | 69691/100000 [00:13<00:05, 5413.40 examples/s]Map:  70%|███████   | 70338/100000 [00:13<00:05, 5345.50 examples/s]Map:  71%|███████   | 71000/100000 [00:13<00:05, 5353.49 examples/s]Map:  72%|███████▏  | 71696/100000 [00:13<00:04, 5762.96 examples/s]Map:  72%|███████▏  | 72340/100000 [00:13<00:04, 5623.24 examples/s]Map:  73%|███████▎  | 73000/100000 [00:14<00:04, 5484.98 examples/s]Map:  74%|███████▎  | 73688/100000 [00:14<00:04, 5847.86 examples/s]Map:  74%|███████▍  | 74338/100000 [00:14<00:04, 5658.72 examples/s]Map:  75%|███████▌  | 75000/100000 [00:14<00:04, 5570.84 examples/s]Map:  76%|███████▌  | 75687/100000 [00:14<00:04, 5910.82 examples/s]Map:  76%|███████▋  | 76340/100000 [00:14<00:04, 5714.33 examples/s]Map:  77%|███████▋  | 77000/100000 [00:14<00:04, 5614.40 examples/s]Map:  78%|███████▊  | 77691/100000 [00:14<00:03, 5957.94 examples/s]Map:  78%|███████▊  | 78335/100000 [00:15<00:03, 5734.35 examples/s]Map:  79%|███████▉  | 79000/100000 [00:15<00:03, 5581.71 examples/s]Map:  80%|███████▉  | 79691/100000 [00:15<00:03, 5929.90 examples/s]Map:  80%|████████  | 80374/100000 [00:15<00:04, 4144.69 examples/s]Map:  81%|████████  | 81000/100000 [00:15<00:04, 4424.35 examples/s]Map:  82%|████████▏ | 81690/100000 [00:15<00:03, 4974.98 examples/s]Map:  82%|████████▏ | 82341/100000 [00:15<00:03, 5075.09 examples/s]Map:  83%|████████▎ | 83000/100000 [00:15<00:03, 5180.68 examples/s]Map:  84%|████████▎ | 83695/100000 [00:16<00:02, 5623.97 examples/s]Map:  84%|████████▍ | 84339/100000 [00:16<00:02, 5461.31 examples/s]Map:  85%|████████▌ | 85000/100000 [00:16<00:02, 5448.32 examples/s]Map:  86%|████████▌ | 85686/100000 [00:16<00:02, 5815.73 examples/s]Map:  86%|████████▋ | 86340/100000 [00:16<00:02, 5653.50 examples/s]Map:  87%|████████▋ | 87000/100000 [00:16<00:02, 5579.26 examples/s]Map:  88%|████████▊ | 87691/100000 [00:16<00:02, 5928.98 examples/s]Map:  88%|████████▊ | 88340/100000 [00:16<00:02, 5734.92 examples/s]Map:  89%|████████▉ | 89000/100000 [00:17<00:01, 5643.43 examples/s]Map:  90%|████████▉ | 89694/100000 [00:17<00:01, 5986.37 examples/s]Map:  90%|█████████ | 90340/100000 [00:17<00:01, 5743.81 examples/s]Map:  91%|█████████ | 91000/100000 [00:17<00:01, 5630.89 examples/s]Map:  92%|█████████▏| 91690/100000 [00:17<00:01, 5967.72 examples/s]Map:  92%|█████████▏| 92338/100000 [00:17<00:01, 5747.76 examples/s]Map:  93%|█████████▎| 93000/100000 [00:17<00:01, 4037.98 examples/s]Map:  94%|█████████▎| 93683/100000 [00:17<00:01, 4615.23 examples/s]Map:  94%|█████████▍| 94341/100000 [00:18<00:01, 4804.56 examples/s]Map:  95%|█████████▌| 95000/100000 [00:18<00:01, 4962.89 examples/s]Map:  96%|█████████▌| 95688/100000 [00:18<00:00, 5426.55 examples/s]Map:  96%|█████████▋| 96339/100000 [00:18<00:00, 5385.64 examples/s]Map:  97%|█████████▋| 97000/100000 [00:18<00:00, 5397.05 examples/s]Map:  98%|█████████▊| 97691/100000 [00:18<00:00, 5787.18 examples/s]Map:  98%|█████████▊| 98338/100000 [00:18<00:00, 5638.99 examples/s]Map:  99%|█████████▉| 99000/100000 [00:18<00:00, 5542.34 examples/s]Map: 100%|█████████▉| 99693/100000 [00:18<00:00, 5906.59 examples/s]Map: 100%|██████████| 100000/100000 [00:19<00:00, 5242.84 examples/s]
Map:   0%|          | 0/10000 [00:00<?, ? examples/s]Map:   7%|▋         | 700/10000 [00:00<00:01, 6933.18 examples/s]Map:  17%|█▋        | 1703/10000 [00:00<00:01, 5897.42 examples/s]Map:  24%|██▎       | 2351/10000 [00:00<00:01, 5633.28 examples/s]Map:  30%|███       | 3000/10000 [00:00<00:01, 5543.75 examples/s]Map:  37%|███▋      | 3693/10000 [00:00<00:01, 5959.87 examples/s]Map:  43%|████▎     | 4348/10000 [00:00<00:01, 5525.15 examples/s]Map:  50%|█████     | 5000/10000 [00:00<00:00, 5475.67 examples/s]Map:  57%|█████▋    | 5693/10000 [00:00<00:00, 5871.97 examples/s]Map:  63%|██████▎   | 6347/10000 [00:01<00:00, 4066.11 examples/s]Map:  70%|███████   | 7000/10000 [00:01<00:00, 4372.28 examples/s]Map:  77%|███████▋  | 7700/10000 [00:01<00:00, 4960.43 examples/s]Map:  83%|████████▎ | 8338/10000 [00:01<00:00, 4762.77 examples/s]Map:  90%|█████████ | 9000/10000 [00:01<00:00, 4903.94 examples/s]Map:  97%|█████████▋| 9691/10000 [00:01<00:00, 5387.85 examples/s]Map: 100%|██████████| 10000/10000 [00:01<00:00, 5175.26 examples/s]
/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/sum/ufj45ra/faithful_reasoning/ft_unsloth_llama3.py", line 166, in <module>
    trainer = SFTTrainer(
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/trl/trainer/sft_trainer.py", line 189, in __init__
    if args.packing and data_collator is not None and isinstance(data_collator, DataCollatorForCompletionOnlyLM):
AttributeError: 'TrainingArguments' object has no attribute 'packing'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Not an error, but Unsloth cannot patch Attention layers with our manual autograd engine since either LoRA adapters
are not enabled or a bias term (like in Qwen) is used.
Unsloth 2024.5 patched 32 layers with 0 QKV layers, 32 O layers and 32 MLP layers.
Map:   0%|          | 0/100000 [00:00<?, ? examples/s]Map:   0%|          | 1/100000 [00:00<5:14:01,  5.31 examples/s]Map:   1%|          | 677/100000 [00:00<00:34, 2914.98 examples/s]Map:   1%|▏         | 1353/100000 [00:00<00:25, 3896.40 examples/s]Map:   2%|▏         | 1989/100000 [00:00<00:30, 3245.65 examples/s]Map:   2%|▏         | 2439/100000 [00:00<00:27, 3550.53 examples/s]Map:   3%|▎         | 3000/100000 [00:00<00:24, 4010.93 examples/s]Map:   4%|▎         | 3686/100000 [00:00<00:20, 4766.52 examples/s]Map:   4%|▍         | 4341/100000 [00:01<00:19, 4964.12 examples/s]Map:   5%|▌         | 5000/100000 [00:01<00:18, 5133.72 examples/s]Map:   6%|▌         | 5697/100000 [00:01<00:16, 5625.97 examples/s]Map:   6%|▋         | 6340/100000 [00:01<00:17, 5451.66 examples/s]Map:   7%|▋         | 7000/100000 [00:01<00:16, 5482.71 examples/s]Map:   8%|▊         | 7688/100000 [00:01<00:15, 5855.04 examples/s]Map:   8%|▊         | 8343/100000 [00:01<00:16, 5725.83 examples/s]Map:   9%|▉         | 9000/100000 [00:01<00:16, 5675.40 examples/s]Map:  10%|▉         | 9690/100000 [00:01<00:15, 6004.63 examples/s]Map:  10%|█         | 10343/100000 [00:02<00:15, 5822.49 examples/s]Map:  11%|█         | 11000/100000 [00:02<00:15, 5743.67 examples/s]Map:  12%|█▏        | 11692/100000 [00:02<00:14, 6061.09 examples/s]Map:  12%|█▏        | 12341/100000 [00:02<00:15, 5679.29 examples/s]Map:  13%|█▎        | 13000/100000 [00:02<00:15, 5634.75 examples/s]Map:  14%|█▎        | 13691/100000 [00:02<00:14, 5973.86 examples/s]Map:  14%|█▍        | 14342/100000 [00:02<00:14, 5809.96 examples/s]Map:  15%|█▌        | 15000/100000 [00:03<00:20, 4130.30 examples/s]Map:  16%|█▌        | 15686/100000 [00:03<00:17, 4704.74 examples/s]Map:  16%|█▋        | 16343/100000 [00:03<00:17, 4908.91 examples/s]Map:  17%|█▋        | 17000/100000 [00:03<00:16, 5079.26 examples/s]Map:  18%|█▊        | 17692/100000 [00:03<00:14, 5531.40 examples/s]Map:  18%|█▊        | 18341/100000 [00:03<00:14, 5508.85 examples/s]Map:  19%|█▉        | 19000/100000 [00:03<00:14, 5510.19 examples/s]Map:  20%|█▉        | 19691/100000 [00:03<00:13, 5876.33 examples/s]Map:  20%|██        | 20343/100000 [00:03<00:13, 5754.18 examples/s]Map:  21%|██        | 21000/100000 [00:04<00:13, 5702.02 examples/s]Map:  22%|██▏       | 21693/100000 [00:04<00:12, 6030.43 examples/s]Map:  22%|██▏       | 22341/100000 [00:04<00:13, 5839.95 examples/s]Map:  23%|██▎       | 23000/100000 [00:04<00:13, 5721.50 examples/s]Map:  24%|██▎       | 23689/100000 [00:04<00:12, 6035.26 examples/s]Map:  24%|██▍       | 24340/100000 [00:04<00:12, 5847.53 examples/s]Map:  25%|██▌       | 25000/100000 [00:04<00:13, 5752.49 examples/s]Map:  26%|██▌       | 25697/100000 [00:04<00:12, 6078.72 examples/s]Map:  26%|██▋       | 26342/100000 [00:04<00:12, 5885.66 examples/s]Map:  27%|██▋       | 27000/100000 [00:05<00:12, 5787.11 examples/s]Map:  28%|██▊       | 27685/100000 [00:05<00:16, 4363.38 examples/s]Map:  28%|██▊       | 28339/100000 [00:05<00:15, 4566.42 examples/s]Map:  29%|██▉       | 29000/100000 [00:05<00:14, 4813.52 examples/s]Map:  30%|██▉       | 29695/100000 [00:05<00:13, 5317.79 examples/s]Map:  30%|███       | 30339/100000 [00:05<00:13, 5354.58 examples/s]Map:  31%|███       | 31000/100000 [00:05<00:12, 5414.93 examples/s]Map:  32%|███▏      | 31668/100000 [00:06<00:11, 5740.63 examples/s]Map:  32%|███▏      | 32342/100000 [00:06<00:11, 5673.26 examples/s]Map:  33%|███▎      | 33000/100000 [00:06<00:11, 5643.40 examples/s]Map:  34%|███▎      | 33685/100000 [00:06<00:11, 5963.76 examples/s]Map:  34%|███▍      | 34340/100000 [00:06<00:11, 5754.96 examples/s]Map:  35%|███▌      | 35000/100000 [00:06<00:11, 5687.74 examples/s]Map:  36%|███▌      | 35693/100000 [00:06<00:10, 6019.07 examples/s]Map:  36%|███▋      | 36340/100000 [00:06<00:10, 5848.44 examples/s]Map:  37%|███▋      | 37000/100000 [00:06<00:10, 5744.46 examples/s]Map:  38%|███▊      | 37689/100000 [00:07<00:10, 6051.86 examples/s]Map:  38%|███▊      | 38340/100000 [00:07<00:10, 5858.62 examples/s]Map:  39%|███▉      | 39000/100000 [00:07<00:10, 5765.29 examples/s]Map:  40%|███▉      | 39688/100000 [00:07<00:09, 6064.01 examples/s]Map:  40%|████      | 40340/100000 [00:07<00:10, 5826.35 examples/s]Map:  41%|████      | 41043/100000 [00:07<00:14, 4146.74 examples/s]Map:  42%|████▏     | 41747/100000 [00:07<00:12, 4747.35 examples/s]Map:  42%|████▏     | 42340/100000 [00:07<00:11, 4886.53 examples/s]Map:  43%|████▎     | 43000/100000 [00:08<00:11, 5059.88 examples/s]Map:  44%|████▎     | 43685/100000 [00:08<00:10, 5501.47 examples/s]Map:  44%|████▍     | 44341/100000 [00:08<00:10, 5489.14 examples/s]Map:  45%|████▌     | 45000/100000 [00:08<00:10, 5469.15 examples/s]Map:  46%|████▌     | 45706/100000 [00:08<00:09, 5883.81 examples/s]Map:  46%|████▋     | 46342/100000 [00:08<00:09, 5749.70 examples/s]Map:  47%|████▋     | 47000/100000 [00:08<00:10, 5039.05 examples/s]Map:  48%|████▊     | 47685/100000 [00:08<00:09, 5483.44 examples/s]Map:  48%|████▊     | 48339/100000 [00:09<00:09, 5467.05 examples/s]Map:  49%|████▉     | 49000/100000 [00:09<00:09, 5432.43 examples/s]Map:  50%|████▉     | 49691/100000 [00:09<00:08, 5813.41 examples/s]Map:  50%|█████     | 50341/100000 [00:09<00:08, 5687.49 examples/s]Map:  51%|█████     | 51000/100000 [00:09<00:08, 5646.07 examples/s]Map:  52%|█████▏    | 51692/100000 [00:09<00:08, 5985.42 examples/s]Map:  52%|█████▏    | 52340/100000 [00:09<00:08, 5827.44 examples/s]Map:  53%|█████▎    | 53000/100000 [00:09<00:08, 5726.36 examples/s]Map:  54%|█████▎    | 53688/100000 [00:09<00:07, 6036.09 examples/s]Map:  54%|█████▍    | 54340/100000 [00:10<00:10, 4167.76 examples/s]Map:  55%|█████▌    | 55000/100000 [00:10<00:09, 4506.60 examples/s]Map:  56%|█████▌    | 55688/100000 [00:10<00:08, 5040.65 examples/s]Map:  56%|█████▋    | 56343/100000 [00:10<00:08, 5149.31 examples/s]Map:  57%|█████▋    | 57000/100000 [00:10<00:08, 5265.57 examples/s]Map:  58%|█████▊    | 57592/100000 [00:10<00:07, 5430.73 examples/s]Map:  58%|█████▊    | 58460/100000 [00:10<00:07, 5553.00 examples/s]Map:  59%|█████▉    | 59338/100000 [00:11<00:07, 5623.09 examples/s]Map:  60%|██████    | 60000/100000 [00:11<00:07, 5562.01 examples/s]Map:  61%|██████    | 60690/100000 [00:11<00:06, 5888.93 examples/s]Map:  61%|██████▏   | 61339/100000 [00:11<00:06, 5744.75 examples/s]Map:  62%|██████▏   | 62000/100000 [00:11<00:06, 5690.53 examples/s]Map:  63%|██████▎   | 62692/100000 [00:11<00:06, 6010.34 examples/s]Map:  63%|██████▎   | 63341/100000 [00:11<00:06, 5836.44 examples/s]Map:  64%|██████▍   | 64000/100000 [00:11<00:06, 5752.51 examples/s]Map:  65%|██████▍   | 64694/100000 [00:11<00:05, 6070.30 examples/s]Map:  65%|██████▌   | 65340/100000 [00:12<00:05, 5872.23 examples/s]Map:  66%|██████▌   | 66000/100000 [00:12<00:05, 5752.00 examples/s]Map:  67%|██████▋   | 66689/100000 [00:12<00:05, 6056.34 examples/s]Map:  67%|██████▋   | 67335/100000 [00:12<00:07, 4199.48 examples/s]Map:  68%|██████▊   | 68000/100000 [00:12<00:07, 4529.38 examples/s]Map:  69%|██████▊   | 68694/100000 [00:12<00:06, 5072.93 examples/s]Map:  69%|██████▉   | 69342/100000 [00:12<00:05, 5176.35 examples/s]Map:  70%|███████   | 70000/100000 [00:13<00:05, 5241.69 examples/s]Map:  71%|███████   | 70693/100000 [00:13<00:05, 5667.27 examples/s]Map:  71%|███████▏  | 71338/100000 [00:13<00:05, 5578.67 examples/s]Map:  72%|███████▏  | 72000/100000 [00:13<00:05, 5568.46 examples/s]Map:  73%|███████▎  | 72690/100000 [00:13<00:04, 5917.19 examples/s]Map:  73%|███████▎  | 73339/100000 [00:13<00:04, 5771.80 examples/s]Map:  74%|███████▍  | 74000/100000 [00:13<00:04, 5695.43 examples/s]Map:  75%|███████▍  | 74687/100000 [00:13<00:04, 6007.87 examples/s]Map:  75%|███████▌  | 75340/100000 [00:13<00:04, 5832.33 examples/s]Map:  76%|███████▌  | 76000/100000 [00:14<00:04, 5741.10 examples/s]Map:  77%|███████▋  | 76696/100000 [00:14<00:03, 6067.51 examples/s]Map:  77%|███████▋  | 77339/100000 [00:14<00:03, 5867.53 examples/s]Map:  78%|███████▊  | 78000/100000 [00:14<00:03, 5772.59 examples/s]Map:  79%|███████▊  | 78689/100000 [00:14<00:03, 6072.89 examples/s]Map:  79%|███████▉  | 79339/100000 [00:14<00:03, 5871.03 examples/s]Map:  80%|████████  | 80025/100000 [00:14<00:04, 4121.26 examples/s]Map:  81%|████████  | 80728/100000 [00:15<00:04, 4725.84 examples/s]Map:  81%|████████▏ | 81341/100000 [00:15<00:03, 4892.90 examples/s]Map:  82%|████████▏ | 82000/100000 [00:15<00:03, 5068.27 examples/s]Map:  83%|████████▎ | 82690/100000 [00:15<00:03, 5519.04 examples/s]Map:  83%|████████▎ | 83340/100000 [00:15<00:03, 5505.25 examples/s]Map:  84%|████████▍ | 84000/100000 [00:15<00:02, 5513.96 examples/s]Map:  85%|████████▍ | 84691/100000 [00:15<00:02, 5877.23 examples/s]Map:  85%|████████▌ | 85342/100000 [00:15<00:02, 5688.83 examples/s]Map:  86%|████████▌ | 86000/100000 [00:15<00:02, 5644.63 examples/s]Map:  87%|████████▋ | 86691/100000 [00:16<00:02, 5979.96 examples/s]Map:  87%|████████▋ | 87342/100000 [00:16<00:02, 5819.13 examples/s]Map:  88%|████████▊ | 88000/100000 [00:16<00:02, 5734.37 examples/s]Map:  89%|████████▊ | 88690/100000 [00:16<00:01, 6045.75 examples/s]Map:  89%|████████▉ | 89340/100000 [00:16<00:01, 5850.92 examples/s]Map:  90%|█████████ | 90000/100000 [00:16<00:01, 5746.16 examples/s]Map:  91%|█████████ | 90687/100000 [00:16<00:01, 6047.38 examples/s]Map:  91%|█████████▏| 91339/100000 [00:16<00:01, 5853.01 examples/s]Map:  92%|█████████▏| 92000/100000 [00:16<00:01, 5746.56 examples/s]Map:  93%|█████████▎| 92691/100000 [00:17<00:01, 6059.71 examples/s]Map:  93%|█████████▎| 93335/100000 [00:17<00:01, 3533.69 examples/s]Map:  94%|█████████▍| 94000/100000 [00:17<00:01, 3944.75 examples/s]Map:  95%|█████████▍| 94684/100000 [00:17<00:01, 4531.02 examples/s]Map:  95%|█████████▌| 95338/100000 [00:17<00:00, 4758.87 examples/s]Map:  96%|█████████▌| 96000/100000 [00:17<00:00, 4968.07 examples/s]Map:  97%|█████████▋| 96689/100000 [00:17<00:00, 5432.09 examples/s]Map:  97%|█████████▋| 97339/100000 [00:18<00:00, 5425.55 examples/s]Map:  98%|█████████▊| 98000/100000 [00:18<00:00, 5456.67 examples/s]Map:  99%|█████████▊| 98698/100000 [00:18<00:00, 5851.44 examples/s]Map:  99%|█████████▉| 99341/100000 [00:18<00:00, 5729.28 examples/s]Map: 100%|██████████| 100000/100000 [00:18<00:00, 5633.05 examples/s]Map: 100%|██████████| 100000/100000 [00:18<00:00, 5386.00 examples/s]
Map:   0%|          | 0/10000 [00:00<?, ? examples/s]Map:   7%|▋         | 702/10000 [00:00<00:01, 6952.36 examples/s]Map:  17%|█▋        | 1705/10000 [00:00<00:01, 6145.54 examples/s]Map:  23%|██▎       | 2343/10000 [00:00<00:01, 5832.80 examples/s]Map:  30%|███       | 3000/10000 [00:00<00:01, 5618.91 examples/s]Map:  37%|███▋      | 3695/10000 [00:00<00:01, 6020.67 examples/s]Map:  43%|████▎     | 4341/10000 [00:00<00:00, 5812.84 examples/s]Map:  50%|█████     | 5000/10000 [00:00<00:00, 5678.91 examples/s]Map:  57%|█████▋    | 5693/10000 [00:00<00:00, 6027.93 examples/s]Map:  63%|██████▎   | 6336/10000 [00:01<00:00, 4048.88 examples/s]Map:  70%|███████   | 7000/10000 [00:01<00:00, 4403.10 examples/s]Map:  77%|███████▋  | 7693/10000 [00:01<00:00, 4969.53 examples/s]Map:  83%|████████▎ | 8340/10000 [00:01<00:00, 5090.26 examples/s]Map:  90%|█████████ | 9000/10000 [00:01<00:00, 5229.34 examples/s]Map:  97%|█████████▋| 9695/10000 [00:01<00:00, 5663.29 examples/s]Map: 100%|██████████| 10000/10000 [00:01<00:00, 5338.00 examples/s]
/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/sum/ufj45ra/faithful_reasoning/ft_unsloth_llama3.py", line 166, in <module>
    trainer = SFTTrainer(
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/trl/trainer/sft_trainer.py", line 189, in __init__
    if args.packing and data_collator is not None and isinstance(data_collator, DataCollatorForCompletionOnlyLM):
AttributeError: 'TrainingArguments' object has no attribute 'packing'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Not an error, but Unsloth cannot patch Attention layers with our manual autograd engine since either LoRA adapters
are not enabled or a bias term (like in Qwen) is used.
Unsloth 2024.5 patched 32 layers with 0 QKV layers, 32 O layers and 32 MLP layers.
Map:   0%|          | 0/100000 [00:00<?, ? examples/s]Map:   0%|          | 1/100000 [00:00<3:38:42,  7.62 examples/s]Map:   1%|          | 652/100000 [00:00<00:29, 3393.80 examples/s]Map:   1%|▏         | 1355/100000 [00:00<00:24, 4072.38 examples/s]Map:   2%|▏         | 1989/100000 [00:00<00:29, 3285.89 examples/s]Map:   2%|▏         | 2410/100000 [00:00<00:27, 3511.90 examples/s]Map:   3%|▎         | 3000/100000 [00:00<00:24, 3951.58 examples/s]Map:   4%|▎         | 3665/100000 [00:00<00:20, 4657.48 examples/s]Map:   4%|▍         | 4330/100000 [00:01<00:20, 4651.89 examples/s]Map:   5%|▌         | 5000/100000 [00:01<00:19, 4843.84 examples/s]Map:   6%|▌         | 5671/100000 [00:01<00:17, 5321.35 examples/s]Map:   6%|▋         | 6328/100000 [00:01<00:17, 5269.46 examples/s]Map:   7%|▋         | 7000/100000 [00:01<00:18, 5028.73 examples/s]Map:   8%|▊         | 7660/100000 [00:01<00:17, 5418.86 examples/s]Map:   8%|▊         | 8475/100000 [00:01<00:16, 5419.30 examples/s]Map:   9%|▉         | 9330/100000 [00:01<00:16, 5441.34 examples/s]Map:  10%|█         | 10000/100000 [00:02<00:16, 5404.11 examples/s]Map:  11%|█         | 10669/100000 [00:02<00:15, 5713.19 examples/s]Map:  11%|█▏        | 11331/100000 [00:02<00:16, 5532.20 examples/s]Map:  12%|█▏        | 12000/100000 [00:02<00:16, 5453.02 examples/s]Map:  13%|█▎        | 12665/100000 [00:02<00:15, 5754.81 examples/s]Map:  13%|█▎        | 13326/100000 [00:02<00:15, 5568.37 examples/s]Map:  14%|█▍        | 13997/100000 [00:02<00:14, 5865.63 examples/s]Map:  15%|█▍        | 14663/100000 [00:02<00:16, 5265.25 examples/s]Map:  15%|█▌        | 15326/100000 [00:03<00:22, 3845.31 examples/s]Map:  16%|█▌        | 16000/100000 [00:03<00:20, 4187.31 examples/s]Map:  17%|█▋        | 16664/100000 [00:03<00:17, 4704.86 examples/s]Map:  17%|█▋        | 17485/100000 [00:03<00:16, 4940.89 examples/s]Map:  18%|█▊        | 18328/100000 [00:03<00:15, 5107.83 examples/s]Map:  19%|█▉        | 19000/100000 [00:03<00:15, 5143.78 examples/s]Map:  20%|█▉        | 19662/100000 [00:04<00:14, 5483.30 examples/s]Map:  20%|██        | 20327/100000 [00:04<00:14, 5340.05 examples/s]Map:  21%|██        | 21000/100000 [00:04<00:14, 5322.80 examples/s]Map:  22%|██▏       | 21666/100000 [00:04<00:13, 5652.31 examples/s]Map:  22%|██▏       | 22325/100000 [00:04<00:14, 5494.51 examples/s]Map:  23%|██▎       | 22996/100000 [00:04<00:13, 5806.98 examples/s]Map:  24%|██▍       | 23809/100000 [00:04<00:13, 5665.15 examples/s]Map:  25%|██▍       | 24668/100000 [00:04<00:13, 5602.38 examples/s]Map:  25%|██▌       | 25330/100000 [00:05<00:13, 5453.27 examples/s]Map:  26%|██▌       | 25989/100000 [00:05<00:12, 5726.80 examples/s]Map:  27%|██▋       | 26794/100000 [00:05<00:13, 5601.39 examples/s]Map:  28%|██▊       | 27665/100000 [00:05<00:13, 5514.67 examples/s]Map:  28%|██▊       | 28327/100000 [00:05<00:17, 4079.36 examples/s]Map:  29%|██▉       | 29000/100000 [00:05<00:16, 4348.18 examples/s]Map:  30%|██▉       | 29673/100000 [00:05<00:14, 4835.69 examples/s]Map:  30%|███       | 30327/100000 [00:06<00:14, 4928.49 examples/s]Map:  31%|███       | 31000/100000 [00:06<00:13, 5029.01 examples/s]Map:  32%|███▏      | 31661/100000 [00:06<00:12, 5404.76 examples/s]Map:  32%|███▏      | 32457/100000 [00:06<00:12, 5367.94 examples/s]Map:  33%|███▎      | 33330/100000 [00:06<00:12, 5372.02 examples/s]Map:  34%|███▍      | 34000/100000 [00:06<00:12, 5301.09 examples/s]Map:  35%|███▍      | 34667/100000 [00:06<00:11, 5622.73 examples/s]Map:  35%|███▌      | 35330/100000 [00:06<00:11, 5490.57 examples/s]Map:  36%|███▌      | 36000/100000 [00:07<00:11, 5439.84 examples/s]Map:  37%|███▋      | 36666/100000 [00:07<00:11, 5745.16 examples/s]Map:  37%|███▋      | 37477/100000 [00:07<00:11, 5622.43 examples/s]Map:  38%|███▊      | 38328/100000 [00:07<00:11, 5579.39 examples/s]Map:  39%|███▉      | 39000/100000 [00:07<00:11, 5497.83 examples/s]Map:  40%|███▉      | 39663/100000 [00:07<00:10, 5772.44 examples/s]Map:  40%|████      | 40327/100000 [00:07<00:10, 5519.13 examples/s]Map:  41%|████      | 40913/100000 [00:08<00:14, 4184.62 examples/s]Map:  42%|████▏     | 41685/100000 [00:08<00:13, 4461.04 examples/s]Map:  42%|████▏     | 42328/100000 [00:08<00:12, 4630.94 examples/s]Map:  43%|████▎     | 43000/100000 [00:08<00:11, 4802.63 examples/s]Map:  44%|████▎     | 43672/100000 [00:08<00:10, 5246.18 examples/s]Map:  44%|████▍     | 44324/100000 [00:08<00:10, 5218.29 examples/s]Map:  45%|████▌     | 45000/100000 [00:08<00:10, 5193.44 examples/s]Map:  46%|████▌     | 45668/100000 [00:08<00:09, 5561.90 examples/s]Map:  46%|████▋     | 46325/100000 [00:09<00:09, 5406.62 examples/s]Map:  47%|████▋     | 47000/100000 [00:09<00:09, 5329.94 examples/s]Map:  48%|████▊     | 47667/100000 [00:09<00:09, 5669.18 examples/s]Map:  48%|████▊     | 48329/100000 [00:09<00:09, 5492.55 examples/s]Map:  49%|████▉     | 49000/100000 [00:09<00:09, 5395.67 examples/s]Map:  50%|████▉     | 49670/100000 [00:09<00:08, 5729.70 examples/s]Map:  50%|█████     | 50327/100000 [00:09<00:09, 5445.04 examples/s]Map:  51%|█████     | 51000/100000 [00:09<00:09, 5382.66 examples/s]Map:  52%|█████▏    | 51664/100000 [00:10<00:08, 5702.67 examples/s]Map:  52%|█████▏    | 52329/100000 [00:10<00:08, 5535.64 examples/s]Map:  53%|█████▎    | 53000/100000 [00:10<00:08, 5454.00 examples/s]Map:  54%|█████▎    | 53668/100000 [00:10<00:08, 5770.50 examples/s]Map:  54%|█████▍    | 54325/100000 [00:10<00:11, 4041.26 examples/s]Map:  55%|█████▍    | 54998/100000 [00:10<00:09, 4595.58 examples/s]Map:  56%|█████▌    | 55658/100000 [00:11<00:11, 3894.37 examples/s]Map:  56%|█████▌    | 56125/100000 [00:11<00:10, 4049.02 examples/s]Map:  57%|█████▋    | 56804/100000 [00:11<00:09, 4658.43 examples/s]Map:  58%|█████▊    | 57664/100000 [00:11<00:08, 4914.59 examples/s]Map:  58%|█████▊    | 58326/100000 [00:11<00:08, 4978.72 examples/s]Map:  59%|█████▉    | 59000/100000 [00:11<00:08, 5057.29 examples/s]Map:  60%|█████▉    | 59671/100000 [00:11<00:07, 5452.49 examples/s]Map:  60%|██████    | 60324/100000 [00:11<00:07, 5288.94 examples/s]Map:  61%|██████    | 60997/100000 [00:11<00:06, 5651.38 examples/s]Map:  62%|██████▏   | 61811/100000 [00:12<00:06, 5569.43 examples/s]Map:  63%|██████▎   | 62666/100000 [00:12<00:06, 5535.34 examples/s]Map:  63%|██████▎   | 63327/100000 [00:12<00:06, 5429.07 examples/s]Map:  64%|██████▍   | 64000/100000 [00:12<00:06, 5362.60 examples/s]Map:  65%|██████▍   | 64661/100000 [00:12<00:06, 5665.24 examples/s]Map:  65%|██████▌   | 65456/100000 [00:12<00:06, 5537.72 examples/s]Map:  66%|██████▋   | 66327/100000 [00:12<00:06, 5507.54 examples/s]Map:  67%|██████▋   | 67000/100000 [00:13<00:08, 4096.51 examples/s]Map:  68%|██████▊   | 67656/100000 [00:13<00:07, 4567.69 examples/s]Map:  68%|██████▊   | 68443/100000 [00:13<00:06, 4763.13 examples/s]Map:  69%|██████▉   | 69000/100000 [00:13<00:06, 4827.13 examples/s]Map:  70%|██████▉   | 69668/100000 [00:13<00:05, 5255.77 examples/s]Map:  70%|███████   | 70325/100000 [00:13<00:05, 5229.34 examples/s]Map:  71%|███████   | 70998/100000 [00:13<00:05, 5604.37 examples/s]Map:  72%|███████▏  | 71813/100000 [00:14<00:05, 5541.00 examples/s]Map:  73%|███████▎  | 72672/100000 [00:14<00:04, 5529.32 examples/s]Map:  73%|███████▎  | 73329/100000 [00:14<00:04, 5352.55 examples/s]Map:  74%|███████▍  | 74000/100000 [00:14<00:04, 5322.74 examples/s]Map:  75%|███████▍  | 74668/100000 [00:14<00:04, 5650.43 examples/s]Map:  75%|███████▌  | 75328/100000 [00:14<00:04, 5510.51 examples/s]Map:  76%|███████▌  | 76000/100000 [00:14<00:04, 5441.72 examples/s]Map:  77%|███████▋  | 76665/100000 [00:14<00:04, 5749.22 examples/s]Map:  77%|███████▋  | 77327/100000 [00:15<00:04, 5559.07 examples/s]Map:  78%|███████▊  | 78000/100000 [00:15<00:04, 5475.62 examples/s]Map:  79%|███████▊  | 78658/100000 [00:15<00:03, 5759.91 examples/s]Map:  79%|███████▉  | 79442/100000 [00:15<00:03, 5566.08 examples/s]Map:  80%|████████  | 80012/100000 [00:15<00:05, 3935.15 examples/s]Map:  81%|████████  | 80690/100000 [00:15<00:04, 4511.83 examples/s]Map:  81%|████████▏ | 81329/100000 [00:15<00:03, 4672.13 examples/s]Map:  82%|████████▏ | 82000/100000 [00:16<00:03, 4826.83 examples/s]Map:  83%|████████▎ | 82666/100000 [00:16<00:03, 5260.70 examples/s]Map:  83%|████████▎ | 83469/100000 [00:16<00:03, 5289.58 examples/s]Map:  84%|████████▍ | 84328/100000 [00:16<00:02, 5288.17 examples/s]Map:  85%|████████▌ | 85000/100000 [00:16<00:02, 5283.38 examples/s]Map:  86%|████████▌ | 85662/100000 [00:16<00:02, 5598.82 examples/s]Map:  86%|████████▋ | 86470/100000 [00:16<00:02, 5523.83 examples/s]Map:  87%|████████▋ | 87327/100000 [00:16<00:02, 5504.99 examples/s]Map:  88%|████████▊ | 88000/100000 [00:17<00:02, 5442.40 examples/s]Map:  89%|████████▊ | 88661/100000 [00:17<00:01, 5720.06 examples/s]Map:  89%|████████▉ | 89465/100000 [00:17<00:01, 5596.61 examples/s]Map:  90%|█████████ | 90325/100000 [00:17<00:01, 5560.14 examples/s]Map:  91%|█████████ | 91000/100000 [00:17<00:01, 5464.79 examples/s]Map:  92%|█████████▏| 91665/100000 [00:17<00:01, 5746.83 examples/s]Map:  92%|█████████▏| 92458/100000 [00:17<00:01, 5588.92 examples/s]Map:  93%|█████████▎| 93325/100000 [00:18<00:01, 4164.82 examples/s]Map:  94%|█████████▍| 94000/100000 [00:18<00:01, 4406.59 examples/s]Map:  95%|█████████▍| 94663/100000 [00:18<00:01, 4852.24 examples/s]Map:  95%|█████████▌| 95476/100000 [00:18<00:00, 5021.71 examples/s]Map:  96%|█████████▋| 96327/100000 [00:18<00:00, 5163.98 examples/s]Map:  97%|█████████▋| 97000/100000 [00:18<00:00, 5189.11 examples/s]Map:  98%|█████████▊| 97669/100000 [00:18<00:00, 5530.13 examples/s]Map:  98%|█████████▊| 98327/100000 [00:19<00:00, 5429.78 examples/s]Map:  99%|█████████▉| 99000/100000 [00:19<00:00, 5344.97 examples/s]Map: 100%|█████████▉| 99666/100000 [00:19<00:00, 5668.28 examples/s]Map: 100%|██████████| 100000/100000 [00:19<00:00, 5148.57 examples/s]
Map:   0%|          | 0/10000 [00:00<?, ? examples/s]Map:   7%|▋         | 679/10000 [00:00<00:01, 6718.42 examples/s]Map:  17%|█▋        | 1672/10000 [00:00<00:01, 5707.66 examples/s]Map:  23%|██▎       | 2326/10000 [00:00<00:01, 5422.40 examples/s]Map:  30%|██▉       | 2996/10000 [00:00<00:01, 5822.93 examples/s]Map:  38%|███▊      | 3808/10000 [00:00<00:01, 5653.74 examples/s]Map:  47%|████▋     | 4672/10000 [00:00<00:00, 5417.73 examples/s]Map:  53%|█████▎    | 5330/10000 [00:00<00:00, 5286.87 examples/s]Map:  60%|██████    | 6000/10000 [00:01<00:01, 3904.53 examples/s]Map:  67%|██████▋   | 6666/10000 [00:01<00:00, 4445.86 examples/s]Map:  73%|███████▎  | 7338/10000 [00:01<00:00, 4418.17 examples/s]Map:  80%|████████  | 8000/10000 [00:01<00:00, 4625.16 examples/s]Map:  87%|████████▋ | 8677/10000 [00:01<00:00, 5112.35 examples/s]Map:  93%|█████████▎| 9322/10000 [00:01<00:00, 5110.96 examples/s]Map: 100%|█████████▉| 9998/10000 [00:01<00:00, 5518.78 examples/s]Map: 100%|██████████| 10000/10000 [00:01<00:00, 5022.88 examples/s]
/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/transformers/training_args.py:1474: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Traceback (most recent call last):
  File "/gpfsdswork/projects/rech/sum/ufj45ra/faithful_reasoning/ft_unsloth_llama3.py", line 166, in <module>
    trainer = SFTTrainer(
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/huggingface_hub/utils/_deprecation.py", line 101, in inner_f
    return f(*args, **kwargs)
  File "/linkhome/rech/genxti01/ufj45ra/.conda/envs/unsloth_env/lib/python3.10/site-packages/trl/trainer/sft_trainer.py", line 189, in __init__
    if args.packing and data_collator is not None and isinstance(data_collator, DataCollatorForCompletionOnlyLM):
AttributeError: 'TrainingArguments' object has no attribute 'packing'
